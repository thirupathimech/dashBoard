<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MySQL Studio - Advanced Table Creator</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Prism.js for Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <!-- Flatpickr for Date Pickers -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    
    <!-- Custom Styles -->
    <style>
        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --secondary: #8b5cf6;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --darker: #111827;
            --light: #f3f4f6;
            --lighter: #f9fafb;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #312e81 100%);
            color: #e5e7eb;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .glass-morphism {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .column-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }
        
        .column-card:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        .btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            border: none;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
            border: none;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #4b5563, #374151);
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
        }
        
        .btn-success:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: none;
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            transform: translateY(-2px);
        }
        
        .form-control, .form-select {
            background: rgba(31, 41, 55, 0.7);
            border: 1px solid rgba(75, 85, 99, 0.5);
            color: #e5e7eb;
            border-radius: 8px;
            padding: 10px 12px;
            transition: all 0.2s ease;
        }
        
        .form-control:focus, .form-select:focus {
            background: rgba(31, 41, 55, 0.9);
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
            outline: none;
        }
        
        .form-label {
            font-weight: 500;
            margin-bottom: 6px;
            color: #d1d5db;
        }
        
        .tab {
            padding: 10px 20px;
            border-radius: 8px 8px 0 0;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .tab.active {
            background: rgba(255, 255, 255, 0.1);
            border-bottom-color: #3b82f6;
        }
        
        .query-output {
            background: #1e293b;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(75, 85, 99, 0.5);
            overflow-x: auto;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .toast.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .toast.info {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }
        
        .floating-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .floating-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(139, 92, 246, 0.6);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 200;
            align-items: center;
            justify-content: center;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: #1f2937;
            border-radius: 12px;
            padding: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        
        .close-modal:hover {
            color: #e5e7eb;
        }
        
        .form-check {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .form-check-input {
            width: 18px;
            height: 18px;
            accent-color: #3b82f6;
        }
        
        .relationship-line {
            stroke: #3b82f6;
            stroke-width: 2;
            fill: none;
        }
        
        .relationship-node {
            fill: #3b82f6;
        }
        
        .code-block {
            background: #1e293b;
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            margin: 16px 0;
        }
        
        .code-block pre {
            margin: 0;
            color: #e5e7eb;
            font-family: 'Fira Code', 'Courier New', monospace;
        }
        
        .history-item {
            background: rgba(31, 41, 55, 0.5);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .history-item:hover {
            background: rgba(31, 41, 55, 0.8);
        }
        
        .history-item-title {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .history-item-date {
            font-size: 0.875rem;
            color: #9ca3af;
        }
        
        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: rgba(31, 41, 55, 0.7);
            color: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .dark-mode-toggle:hover {
            background: rgba(31, 41, 55, 0.9);
        }
        
        .light-mode {
            background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
            color: #1f2937;
        }
        
        .light-mode .glass-morphism {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .light-mode .column-card {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .light-mode .column-card:hover {
            background: rgba(255, 255, 255, 0.7);
        }
        
        .light-mode .form-control, .light-mode .form-select {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(0, 0, 0, 0.1);
            color: #1f2937;
        }
        
        .light-mode .form-control:focus, .light-mode .form-select:focus {
            background: rgba(255, 255, 255, 0.9);
            border-color: #3b82f6;
        }
        
        .light-mode .form-label {
            color: #4b5563;
        }
        
        .light-mode .tab {
            color: #4b5563;
        }
        
        .light-mode .tab.active {
            background: rgba(255, 255, 255, 0.7);
        }
        
        .light-mode .query-output {
            background: #f9fafb;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .light-mode .modal-content {
            background: #f9fafb;
        }
        
        .light-mode .modal-title {
            color: #1f2937;
        }
        
        .light-mode .close-modal {
            color: #6b7280;
        }
        
        .light-mode .close-modal:hover {
            color: #1f2937;
        }
        
        .light-mode .code-block {
            background: #f3f4f6;
        }
        
        .light-mode .code-block pre {
            color: #1f2937;
        }
        
        .light-mode .history-item {
            background: rgba(255, 255, 255, 0.7);
        }
        
        .light-mode .history-item:hover {
            background: rgba(255, 255, 255, 0.9);
        }
        
        .light-mode .history-item-date {
            color: #6b7280;
        }
        
        .light-mode .dark-mode-toggle {
            background: rgba(255, 255, 255, 0.7);
            color: #1f2937;
        }
        
        .light-mode .dark-mode-toggle:hover {
            background: rgba(255, 255, 255, 0.9);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }
            
            .column-card {
                padding: 12px;
            }
            
            .btn {
                padding: 6px 12px;
                font-size: 0.875rem;
            }
            
            .modal-content {
                padding: 16px;
            }
            
            .query-output {
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Dark Mode Toggle -->
    <div class="dark-mode-toggle" onclick="toggleDarkMode()">
        <i class="fas fa-moon" id="darkModeIcon"></i>
    </div>
    
    <!-- Header -->
    <header class="glass-morphism py-4 px-6 mb-6">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3">
                <i class="fas fa-database text-3xl text-blue-400"></i>
                <h1 class="text-2xl font-bold">MySQL Studio</h1>
            </div>
            <div class="flex gap-2">
                <button class="btn btn-secondary" onclick="showImportModal()">
                    <i class="fas fa-file-import"></i> Import
                </button>
                <button class="btn btn-secondary" onclick="showExportModal()">
                    <i class="fas fa-file-export"></i> Export
                </button>
                <button class="btn btn-secondary" onclick="showHistoryModal()">
                    <i class="fas fa-history"></i> History
                </button>
            </div>
        </div>
    </header>
    
    <!-- Main Content -->
    <main class="container mx-auto px-4 pb-20">
        <!-- Table Name -->
        <div class="glass-morphism p-6 rounded-xl mb-6">
            <div class="mb-4">
                <label for="tableName" class="form-label">Table Name</label>
                <input type="text" class="form-control w-full" id="tableName" placeholder="e.g., users" required>
                <div class="invalid-feedback text-red-400 text-sm mt-1" id="tableNameError"></div>
            </div>
            
            <!-- Table Description -->
            <div class="mb-4">
                <label for="tableDescription" class="form-label">Table Description</label>
                <textarea class="form-control w-full" id="tableDescription" rows="2" placeholder="Optional description for the table"></textarea>
            </div>
            
            <!-- Tabs -->
            <div class="flex border-b border-gray-700 mb-6">
                <div class="tab active" onclick="switchTab('create')">
                    <i class="fas fa-plus-circle mr-2"></i> Create Table
                </div>
                <div class="tab" onclick="switchTab('alter')">
                    <i class="fas fa-edit mr-2"></i> Alter Table
                </div>
                <div class="tab" onclick="switchTab('indexes')">
                    <i class="fas fa-key mr-2"></i> Indexes
                </div>
                <div class="tab" onclick="switchTab('relationships')">
                    <i class="fas fa-project-diagram mr-2"></i> Relationships
                </div>
                <div class="tab" onclick="switchTab('orm')">
                    <i class="fas fa-code mr-2"></i> ORM Code
                </div>
            </div>
            
            <!-- Tab Content -->
            <div id="createTab" class="tab-content">
                <form id="createForm" onsubmit="generateQuery(event, false)">
                    <div class="mb-4 flex justify-between items-center">
                        <h3 class="text-lg font-semibold">Columns</h3>
                        <button type="button" class="btn btn-primary" onclick="addColumn()">
                            <i class="fas fa-plus"></i> Add Column
                        </button>
                    </div>
                    
                    <div id="columns">
                        <!-- Initial column will be added here -->
                    </div>
                    
                    <!-- Table Options -->
                    <div class="mt-6">
                        <h3 class="text-lg font-semibold mb-4">Table Options</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label for="engine" class="form-label">Engine</label>
                                <select class="form-select w-full" id="engine" name="engine">
                                    <option value="InnoDB">InnoDB</option>
                                    <option value="MyISAM">MyISAM</option>
                                    <option value="MEMORY">MEMORY</option>
                                    <option value="ARCHIVE">ARCHIVE</option>
                                </select>
                            </div>
                            <div>
                                <label for="charset" class="form-label">Charset</label>
                                <select class="form-select w-full" id="charset" name="charset">
                                    <option value="utf8mb4">utf8mb4</option>
                                    <option value="utf8">utf8</option>
                                    <option value="latin1">latin1</option>
                                </select>
                            </div>
                            <div>
                                <label for="collation" class="form-label">Collation</label>
                                <select class="form-select w-full" id="collation" name="collation">
                                    <option value="utf8mb4_unicode_ci">utf8mb4_unicode_ci</option>
                                    <option value="utf8_general_ci">utf8_general_ci</option>
                                    <option value="latin1_swedish_ci">latin1_swedish_ci</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-end">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-magic mr-2"></i> Generate Query
                        </button>
                    </div>
                </form>
            </div>
            
            <div id="alterTab" class="tab-content hidden">
                <form id="alterForm" onsubmit="generateQuery(event, true)">
                    <div class="mb-4">
                        <label for="alterAction" class="form-label">Action</label>
                        <select class="form-select w-full" id="alterAction" name="alterAction" onchange="toggleAlterFields(this)">
                            <option value="">Select Action</option>
                            <option value="ADD">Add Column</option>
                            <option value="MODIFY">Modify Column</option>
                            <option value="DROP">Drop Column</option>
                            <option value="ADD_FK">Add Foreign Key</option>
                            <option value="DROP_FK">Drop Foreign Key</option>
                            <option value="ADD_INDEX">Add Index</option>
                            <option value="DROP_INDEX">Drop Index</option>
                        </select>
                    </div>
                    
                    <div id="alterFields" class="hidden">
                        <!-- Alter fields will be populated based on action -->
                    </div>
                    
                    <div class="mt-6 flex justify-end">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-magic mr-2"></i> Generate Query
                        </button>
                    </div>
                </form>
            </div>
            
            <div id="indexesTab" class="tab-content hidden">
                <div class="mb-4">
                    <h3 class="text-lg font-semibold mb-4">Table Indexes</h3>
                    <div id="indexes">
                        <!-- Indexes will be added here -->
                    </div>
                    <button type="button" class="btn btn-primary mt-4" onclick="addIndex()">
                        <i class="fas fa-plus"></i> Add Index
                    </button>
                </div>
                
                <div class="mt-6 flex justify-end">
                    <button type="button" class="btn btn-primary" onclick="generateIndexesQuery()">
                        <i class="fas fa-magic mr-2"></i> Generate Index Query
                    </button>
                </div>
            </div>
            
            <div id="relationshipsTab" class="tab-content hidden">
                <div class="mb-4">
                    <h3 class="text-lg font-semibold mb-4">Table Relationships</h3>
                    <div class="glass-morphism p-4 rounded-lg">
                        <svg id="relationshipDiagram" width="100%" height="400"></svg>
                    </div>
                    <div id="relationships">
                        <!-- Relationships will be added here -->
                    </div>
                    <button type="button" class="btn btn-primary mt-4" onclick="addRelationship()">
                        <i class="fas fa-plus"></i> Add Relationship
                    </button>
                </div>
                
                <div class="mt-6 flex justify-end">
                    <button type="button" class="btn btn-primary" onclick="generateRelationshipsQuery()">
                        <i class="fas fa-magic mr-2"></i> Generate Relationship Query
                    </button>
                </div>
            </div>
            
            <div id="ormTab" class="tab-content hidden">
                <div class="mb-4">
                    <h3 class="text-lg font-semibold mb-4">ORM Code Generation</h3>
                    <div class="mb-4">
                        <label for="ormFramework" class="form-label">Select Framework</label>
                        <select class="form-select w-full" id="ormFramework" onchange="updateORMCode()">
                            <option value="sequelize">Sequelize (Node.js)</option>
                            <option value="typeorm">TypeORM (Node.js/TypeScript)</option>
                            <option value="eloquent">Eloquent (Laravel/PHP)</option>
                            <option value="sqlalchemy">SQLAlchemy (Python)</option>
                            <option value="activerecord">ActiveRecord (Ruby on Rails)</option>
                            <option value="gorm">GORM (Go)</option>
                        </select>
                    </div>
                    
                    <div class="code-block">
                        <pre id="ormCode"><code>// Select a framework to generate ORM code</code></pre>
                    </div>
                    
                    <div class="mt-4 flex justify-end">
                        <button type="button" class="btn btn-success" onclick="copyORMCode()">
                            <i class="fas fa-copy mr-2"></i> Copy Code
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Query Output -->
        <div id="queryOutput" class="hidden">
            <div class="glass-morphism p-6 rounded-xl">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold">Generated Query</h3>
                    <div class="flex gap-2">
                        <button class="btn btn-secondary" onclick="formatQuery()">
                            <i class="fas fa-indent"></i> Format
                        </button>
                        <button class="btn btn-success" onclick="copyQuery()">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                        <button class="btn btn-primary" onclick="saveToHistory()">
                            <i class="fas fa-save"></i> Save
                        </button>
                    </div>
                </div>
                
                <div class="code-block">
                    <pre id="queryCode"><code></code></pre>
                </div>
                
                <div class="mt-4 flex justify-end">
                    <button class="btn btn-primary" onclick="executeQuery()">
                        <i class="fas fa-play mr-2"></i> Execute Query
                    </button>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Floating Action Button -->
    <div class="floating-button" onclick="showQuickActions()">
        <i class="fas fa-plus"></i>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Success!</span>
    </div>
    
    <!-- Modals -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Import Table Structure</h2>
                <button class="close-modal" onclick="closeModal('importModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="mb-4">
                    <label for="importSource" class="form-label">Import From</label>
                    <select class="form-select w-full" id="importSource" onchange="updateImportOptions()">
                        <option value="sql">SQL File</option>
                        <option value="json">JSON File</option>
                        <option value="yaml">YAML File</option>
                        <option value="database">Existing Database</option>
                    </select>
                </div>
                
                <div id="importOptions" class="mb-4">
                    <!-- Import options will be updated based on source -->
                </div>
                
                <div class="flex justify-end">
                    <button class="btn btn-primary" onclick="importTableStructure()">
                        <i class="fas fa-file-import mr-2"></i> Import
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Export Table Structure</h2>
                <button class="close-modal" onclick="closeModal('exportModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="mb-4">
                    <label for="exportFormat" class="form-label">Export Format</label>
                    <select class="form-select w-full" id="exportFormat">
                        <option value="sql">SQL</option>
                        <option value="json">JSON</option>
                        <option value="yaml">YAML</option>
                        <option value="markdown">Markdown</option>
                    </select>
                </div>
                
                <div class="mb-4">
                    <label for="exportOptions" class="form-label">Export Options</label>
                    <div class="space-y-2">
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="includeData" checked>
                            <label for="includeData" class="form-check-label">Include Sample Data</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="includeIndexes" checked>
                            <label for="includeIndexes" class="form-check-label">Include Indexes</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="includeConstraints" checked>
                            <label for="includeConstraints" class="form-check-label">Include Constraints</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="includeComments">
                            <label for="includeComments" class="form-check-label">Include Comments</label>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end">
                    <button class="btn btn-primary" onclick="exportTableStructure()">
                        <i class="fas fa-file-export mr-2"></i> Export
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="historyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Query History</h2>
                <button class="close-modal" onclick="closeModal('historyModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="historyList">
                    <!-- History items will be populated here -->
                </div>
            </div>
        </div>
    </div>
    
    <div id="quickActionsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Quick Actions</h2>
                <button class="close-modal" onclick="closeModal('quickActionsModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="grid grid-cols-2 gap-4">
                    <button class="btn btn-secondary w-full" onclick="loadTemplate('users')">
                        <i class="fas fa-users mr-2"></i> Users Table
                    </button>
                    <button class="btn btn-secondary w-full" onclick="loadTemplate('products')">
                        <i class="fas fa-box mr-2"></i> Products Table
                    </button>
                    <button class="btn btn-secondary w-full" onclick="loadTemplate('orders')">
                        <i class="fas fa-shopping-cart mr-2"></i> Orders Table
                    </button>
                    <button class="btn btn-secondary w-full" onclick="loadTemplate('posts')">
                        <i class="fas fa-blog mr-2"></i> Blog Posts Table
                    </button>
                    <button class="btn btn-secondary w-full" onclick="loadTemplate('categories')">
                        <i class="fas fa-tags mr-2"></i> Categories Table
                    </button>
                    <button class="btn btn-secondary w-full" onclick="loadTemplate('comments')">
                        <i class="fas fa-comments mr-2"></i> Comments Table
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/sql-formatter@4.0.2/dist/sql-formatter.min.js"></script>
    
    <script>
        // Global variables
        let columnCount = 0;
        let indexCount = 0;
        let relationshipCount = 0;
        let queryHistory = [];
        let currentTab = 'create';
        
        // Data types with length requirements
        const lengthApplicableTypes = ['VARCHAR', 'CHAR', 'INT', 'FLOAT', 'DECIMAL'];
        const integerTypes = ['INT', 'BIGINT', 'SMALLINT', 'TINYINT'];
        const numericTypes = ['INT', 'BIGINT', 'SMALLINT', 'TINYINT', 'FLOAT', 'DECIMAL', 'DOUBLE'];
        const stringTypes = ['VARCHAR', 'CHAR', 'TEXT', 'LONGTEXT', 'MEDIUMTEXT', 'TINYTEXT'];
        const dateTypes = ['DATE', 'DATETIME', 'TIMESTAMP', 'TIME', 'YEAR'];
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Load history from localStorage
            const savedHistory = localStorage.getItem('mysqlStudioHistory');
            if (savedHistory) {
                queryHistory = JSON.parse(savedHistory);
            }
            
            // Add initial column
            addColumn();
            
            // Check for dark mode preference
            if (localStorage.getItem('darkMode') === 'false') {
                document.body.classList.add('light-mode');
                document.getElementById('darkModeIcon').className = 'fas fa-sun';
            }
        });
        
        // Tab switching
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            
            // Add active class to selected tab
            event.target.closest('.tab').classList.add('active');
            
            currentTab = tabName;
            
            // Update ORM code if switching to ORM tab
            if (tabName === 'orm') {
                updateORMCode();
            }
        }
        
        // Dark mode toggle
        function toggleDarkMode() {
            document.body.classList.toggle('light-mode');
            const isDarkMode = !document.body.classList.contains('light-mode');
            localStorage.setItem('darkMode', isDarkMode);
            
            const icon = document.getElementById('darkModeIcon');
            icon.className = isDarkMode ? 'fas fa-moon' : 'fas fa-sun';
        }
        
        // Column management
        function addColumn() {
            const columnsDiv = document.getElementById('columns');
            const columnIndex = columnCount++;
            
            const columnCard = document.createElement('div');
            columnCard.className = 'column-card';
            columnCard.id = `column-${columnIndex}`;
            
            columnCard.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <h4 class="font-medium">Column ${columnIndex + 1}</h4>
                    <button type="button" class="btn btn-danger btn-sm" onclick="removeColumn(${columnIndex})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                        <label class="form-label">Column Name</label>
                        <input type="text" class="form-control" id="columnName${columnIndex}" placeholder="e.g., id" required>
                        <div class="invalid-feedback text-red-400 text-sm mt-1" id="columnNameError${columnIndex}"></div>
                    </div>
                    
                    <div>
                        <label class="form-label">Data Type</label>
                        <select class="form-select" id="columnType${columnIndex}" onchange="toggleLengthField(${columnIndex})" required>
                            <option value="">Select Type</option>
                            <optgroup label="Numeric">
                                <option value="INT">INT</option>
                                <option value="BIGINT">BIGINT</option>
                                <option value="SMALLINT">SMALLINT</option>
                                <option value="TINYINT">TINYINT</option>
                                <option value="DECIMAL">DECIMAL</option>
                                <option value="FLOAT">FLOAT</option>
                                <option value="DOUBLE">DOUBLE</option>
                            </optgroup>
                            <optgroup label="String">
                                <option value="VARCHAR">VARCHAR</option>
                                <option value="CHAR">CHAR</option>
                                <option value="TEXT">TEXT</option>
                                <option value="LONGTEXT">LONGTEXT</option>
                                <option value="MEDIUMTEXT">MEDIUMTEXT</option>
                                <option value="TINYTEXT">TINYTEXT</option>
                            </optgroup>
                            <optgroup label="Date/Time">
                                <option value="DATE">DATE</option>
                                <option value="DATETIME">DATETIME</option>
                                <option value="TIMESTAMP">TIMESTAMP</option>
                                <option value="TIME">TIME</option>
                                <option value="YEAR">YEAR</option>
                            </optgroup>
                            <optgroup label="Other">
                                <option value="BOOLEAN">BOOLEAN</option>
                                <option value="JSON">JSON</option>
                                <option value="ENUM">ENUM</option>
                                <option value="SET">SET</option>
                                <option value="BLOB">BLOB</option>
                            </optgroup>
                        </select>
                        <div class="invalid-feedback text-red-400 text-sm mt-1" id="columnTypeError${columnIndex}"></div>
                    </div>
                    
                    <div id="lengthSection${columnIndex}" class="hidden">
                        <label class="form-label">Length/Precision</label>
                        <input type="text" class="form-control" id="columnLength${columnIndex}" placeholder="e.g., 255">
                        <div class="invalid-feedback text-red-400 text-sm mt-1" id="columnLengthError${columnIndex}"></div>
                    </div>
                    
                    <div id="enumSection${columnIndex}" class="hidden">
                        <label class="form-label">Enum Values (comma-separated)</label>
                        <input type="text" class="form-control" id="columnEnum${columnIndex}" placeholder="e.g., 'active','inactive','pending'">
                        <div class="invalid-feedback text-red-400 text-sm mt-1" id="columnEnumError${columnIndex}"></div>
                    </div>
                    
                    <div>
                        <label class="form-label">Default Value</label>
                        <input type="text" class="form-control" id="columnDefault${columnIndex}" placeholder="e.g., 0, 'text', NULL">
                        <div class="invalid-feedback text-red-400 text-sm mt-1" id="columnDefaultError${columnIndex}"></div>
                    </div>
                    
                    <div>
                        <label class="form-label">Comment</label>
                        <input type="text" class="form-control" id="columnComment${columnIndex}" placeholder="Optional column comment">
                    </div>
                </div>
                
                <div class="mt-4">
                    <label class="form-label">Constraints</label>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="columnPrimary${columnIndex}">
                            <label class="form-check-label" for="columnPrimary${columnIndex}">Primary Key</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="columnUnique${columnIndex}">
                            <label class="form-check-label" for="columnUnique${columnIndex}">Unique</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="columnNotNull${columnIndex}">
                            <label class="form-check-label" for="columnNotNull${columnIndex}">Not Null</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="columnAutoIncrement${columnIndex}">
                            <label class="form-check-label" for="columnAutoIncrement${columnIndex}">Auto Increment</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="columnUnsigned${columnIndex}">
                            <label class="form-check-label" for="columnUnsigned${columnIndex}">Unsigned</label>
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="columnForeign${columnIndex}" onchange="toggleForeignKey(${columnIndex})">
                            <label class="form-check-label" for="columnForeign${columnIndex}">Foreign Key</label>
                        </div>
                    </div>
                    <div class="invalid-feedback text-red-400 text-sm mt-1" id="columnConstraintError${columnIndex}"></div>
                </div>
                
                <div id="foreignKeySection${columnIndex}" class="mt-4 hidden">
                    <label class="form-label">Foreign Key Reference</label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <input type="text" class="form-control" id="columnFkTable${columnIndex}" placeholder="Reference Table">
                            <div class="invalid-feedback text-red-400 text-sm mt-1" id="fkTableError${columnIndex}"></div>
                        </div>
                        <div>
                            <input type="text" class="form-control" id="columnFkColumn${columnIndex}" placeholder="Reference Column">
                            <div class="invalid-feedback text-red-400 text-sm mt-1" id="fkColumnError${columnIndex}"></div>
                        </div>
                    </div>
                    <div class="mt-2">
                        <select class="form-select" id="columnFkOnDelete${columnIndex}">
                            <option value="RESTRICT">ON DELETE RESTRICT</option>
                            <option value="CASCADE">ON DELETE CASCADE</option>
                            <option value="SET NULL">ON DELETE SET NULL</option>
                            <option value="NO ACTION">ON DELETE NO ACTION</option>
                        </select>
                    </div>
                    <div class="mt-2">
                        <select class="form-select" id="columnFkOnUpdate${columnIndex}">
                            <option value="RESTRICT">ON UPDATE RESTRICT</option>
                            <option value="CASCADE">ON UPDATE CASCADE</option>
                            <option value="SET NULL">ON UPDATE SET NULL</option>
                            <option value="NO ACTION">ON UPDATE NO ACTION</option>
                        </select>
                    </div>
                </div>
            `;
            
            columnsDiv.appendChild(columnCard);
        }
        
        function removeColumn(index) {
            const column = document.getElementById(`column-${index}`);
            if (column) {
                column.remove();
                showToast('Column removed', 'info');
            }
        }
        
        function toggleLengthField(columnIndex) {
            const typeSelect = document.getElementById(`columnType${columnIndex}`);
            const lengthSection = document.getElementById(`lengthSection${columnIndex}`);
            const enumSection = document.getElementById(`enumSection${columnIndex}`);
            
            if (typeSelect.value === 'ENUM' || typeSelect.value === 'SET') {
                lengthSection.classList.add('hidden');
                enumSection.classList.remove('hidden');
            } else if (lengthApplicableTypes.includes(typeSelect.value)) {
                lengthSection.classList.remove('hidden');
                enumSection.classList.add('hidden');
            } else {
                lengthSection.classList.add('hidden');
                enumSection.classList.add('hidden');
            }
        }
        
        function toggleForeignKey(columnIndex) {
            const foreignKeyCheckbox = document.getElementById(`columnForeign${columnIndex}`);
            const foreignKeySection = document.getElementById(`foreignKeySection${columnIndex}`);
            
            if (foreignKeyCheckbox.checked) {
                foreignKeySection.classList.remove('hidden');
            } else {
                foreignKeySection.classList.add('hidden');
            }
        }
        
        // Index management
        function addIndex() {
            const indexesDiv = document.getElementById('indexes');
            const indexId = indexCount++;
            
            const indexCard = document.createElement('div');
            indexCard.className = 'column-card';
            indexCard.id = `index-${indexId}`;
            
            indexCard.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <h4 class="font-medium">Index ${indexId + 1}</h4>
                    <button type="button" class="btn btn-danger btn-sm" onclick="removeIndex(${indexId})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label">Index Name</label>
                        <input type="text" class="form-control" id="indexName${indexId}" placeholder="e.g., idx_email">
                    </div>
                    
                    <div>
                        <label class="form-label">Index Type</label>
                        <select class="form-select" id="indexType${indexId}">
                            <option value="INDEX">INDEX</option>
                            <option value="UNIQUE">UNIQUE</option>
                            <option value="FULLTEXT">FULLTEXT</option>
                            <option value="SPATIAL">SPATIAL</option>
                        </select>
                    </div>
                    
                    <div class="md:col-span-2">
                        <label class="form-label">Columns (comma-separated)</label>
                        <input type="text" class="form-control" id="indexColumns${indexId}" placeholder="e.g., email, name">
                    </div>
                </div>
            `;
            
            indexesDiv.appendChild(indexCard);
        }
        
        function removeIndex(indexId) {
            const index = document.getElementById(`index-${indexId}`);
            if (index) {
                index.remove();
                showToast('Index removed', 'info');
            }
        }
        
        // Relationship management
        function addRelationship() {
            const relationshipsDiv = document.getElementById('relationships');
            const relationshipId = relationshipCount++;
            
            const relationshipCard = document.createElement('div');
            relationshipCard.className = 'column-card';
            relationshipCard.id = `relationship-${relationshipId}`;
            
            relationshipCard.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <h4 class="font-medium">Relationship ${relationshipId + 1}</h4>
                    <button type="button" class="btn btn-danger btn-sm" onclick="removeRelationship(${relationshipId})">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="form-label">Source Table</label>
                        <input type="text" class="form-control" id="relSourceTable${relationshipId}" placeholder="e.g., users">
                    </div>
                    
                    <div>
                        <label class="form-label">Source Column</label>
                        <input type="text" class="form-control" id="relSourceColumn${relationshipId}" placeholder="e.g., id">
                    </div>
                    
                    <div>
                        <label class="form-label">Target Table</label>
                        <input type="text" class="form-control" id="relTargetTable${relationshipId}" placeholder="e.g., posts">
                    </div>
                    
                    <div>
                        <label class="form-label">Target Column</label>
                        <input type="text" class="form-control" id="relTargetColumn${relationshipId}" placeholder="e.g., user_id">
                    </div>
                    
                    <div>
                        <label class="form-label">Relationship Type</label>
                        <select class="form-select" id="relType${relationshipId}">
                            <option value="ONE_TO_ONE">One to One</option>
                            <option value="ONE_TO_MANY">One to Many</option>
                            <option value="MANY_TO_MANY">Many to Many</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="form-label">Constraint Name</label>
                        <input type="text" class="form-control" id="relConstraintName${relationshipId}" placeholder="e.g., fk_user_posts">
                    </div>
                </div>
            `;
            
            relationshipsDiv.appendChild(relationshipCard);
        }
        
        function removeRelationship(relationshipId) {
            const relationship = document.getElementById(`relationship-${relationshipId}`);
            if (relationship) {
                relationship.remove();
                showToast('Relationship removed', 'info');
            }
        }
        
        // Alter table functions
        function toggleAlterFields(select) {
            const action = select.value;
            const alterFields = document.getElementById('alterFields');
            
            if (!action) {
                alterFields.classList.add('hidden');
                return;
            }
            
            alterFields.classList.remove('hidden');
            
            let fieldsHTML = '';
            
            switch (action) {
                case 'ADD':
                case 'MODIFY':
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label">Column Name</label>
                                <input type="text" class="form-control" id="alterColumnName" placeholder="e.g., email">
                                <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterColumnNameError"></div>
                            </div>
                            
                            <div>
                                <label class="form-label">Data Type</label>
                                <select class="form-select" id="alterColumnType" onchange="toggleAlterLengthField()">
                                    <option value="">Select Type</option>
                                    <optgroup label="Numeric">
                                        <option value="INT">INT</option>
                                        <option value="BIGINT">BIGINT</option>
                                        <option value="DECIMAL">DECIMAL</option>
                                        <option value="FLOAT">FLOAT</option>
                                    </optgroup>
                                    <optgroup label="String">
                                        <option value="VARCHAR">VARCHAR</option>
                                        <option value="CHAR">CHAR</option>
                                        <option value="TEXT">TEXT</option>
                                    </optgroup>
                                    <optgroup label="Date/Time">
                                        <option value="DATE">DATE</option>
                                        <option value="DATETIME">DATETIME</option>
                                        <option value="TIMESTAMP">TIMESTAMP</option>
                                    </optgroup>
                                    <optgroup label="Other">
                                        <option value="BOOLEAN">BOOLEAN</option>
                                        <option value="JSON">JSON</option>
                                    </optgroup>
                                </select>
                                <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterColumnTypeError"></div>
                            </div>
                            
                            <div id="alterLengthSection" class="hidden">
                                <label class="form-label">Length/Precision</label>
                                <input type="text" class="form-control" id="alterColumnLength" placeholder="e.g., 255">
                                <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterColumnLengthError"></div>
                            </div>
                            
                            <div>
                                <label class="form-label">Default Value</label>
                                <input type="text" class="form-control" id="alterColumnDefault" placeholder="e.g., 0, 'text', NULL">
                                <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterColumnDefaultError"></div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <label class="form-label">Constraints</label>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="alterNotNull">
                                    <label class="form-check-label" for="alterNotNull">Not Null</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="alterUnique">
                                    <label class="form-check-label" for="alterUnique">Unique</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="alterAutoIncrement">
                                    <label class="form-check-label" for="alterAutoIncrement">Auto Increment</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="alterPrimary">
                                    <label class="form-check-label" for="alterPrimary">Primary Key</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="alterForeign" onchange="toggleAlterForeignKey()">
                                    <label class="form-check-label" for="alterForeign">Foreign Key</label>
                                </div>
                            </div>
                            <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterConstraintError"></div>
                        </div>
                        
                        <div id="alterForeignKeySection" class="mt-4 hidden">
                            <label class="form-label">Foreign Key Reference</label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <input type="text" class="form-control" id="alterFkTable" placeholder="Reference Table">
                                    <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterFkTableError"></div>
                                </div>
                                <div>
                                    <input type="text" class="form-control" id="alterFkColumn" placeholder="Reference Column">
                                    <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterFkColumnError"></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'DROP':
                    fieldsHTML = `
                        <div>
                            <label class="form-label">Column Name</label>
                            <input type="text" class="form-control" id="alterColumnName" placeholder="e.g., email">
                            <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterColumnNameError"></div>
                        </div>
                    `;
                    break;
                    
                case 'ADD_FK':
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label">Column Name</label>
                                <input type="text" class="form-control" id="alterColumnName" placeholder="e.g., user_id">
                                <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterColumnNameError"></div>
                            </div>
                            
                            <div>
                                <label class="form-label">Constraint Name</label>
                                <input type="text" class="form-control" id="alterFkName" placeholder="e.g., fk_user_posts">
                                <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterFkNameError"></div>
                            </div>
                            
                            <div>
                                <label class="form-label">Reference Table</label>
                                <input type="text" class="form-control" id="alterFkTable" placeholder="e.g., users">
                                <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterFkTableError"></div>
                            </div>
                            
                            <div>
                                <label class="form-label">Reference Column</label>
                                <input type="text" class="form-control" id="alterFkColumn" placeholder="e.g., id">
                                <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterFkColumnError"></div>
                            </div>
                            
                            <div>
                                <label class="form-label">On Delete</label>
                                <select class="form-select" id="alterFkOnDelete">
                                    <option value="RESTRICT">RESTRICT</option>
                                    <option value="CASCADE">CASCADE</option>
                                    <option value="SET NULL">SET NULL</option>
                                    <option value="NO ACTION">NO ACTION</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="form-label">On Update</label>
                                <select class="form-select" id="alterFkOnUpdate">
                                    <option value="RESTRICT">RESTRICT</option>
                                    <option value="CASCADE">CASCADE</option>
                                    <option value="SET NULL">SET NULL</option>
                                    <option value="NO ACTION">NO ACTION</option>
                                </select>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'DROP_FK':
                    fieldsHTML = `
                        <div>
                            <label class="form-label">Constraint Name</label>
                            <input type="text" class="form-control" id="alterFkName" placeholder="e.g., fk_user_posts">
                            <div class="invalid-feedback text-red-400 text-sm mt-1" id="alterFkNameError"></div>
                        </div>
                    `;
                    break;
                    
                case 'ADD_INDEX':
                    fieldsHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label">Index Name</label>
                                <input type="text" class="form-control" id="alterIndexName" placeholder="e.g., idx_email">
                            </div>
                            
                            <div>
                                <label class="form-label">Index Type</label>
                                <select class="form-select" id="alterIndexType">
                                    <option value="INDEX">INDEX</option>
                                    <option value="UNIQUE">UNIQUE</option>
                                    <option value="FULLTEXT">FULLTEXT</option>
                                </select>
                            </div>
                            
                            <div class="md:col-span-2">
                                <label class="form-label">Columns (comma-separated)</label>
                                <input type="text" class="form-control" id="alterIndexColumns" placeholder="e.g., email, name">
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'DROP_INDEX':
                    fieldsHTML = `
                        <div>
                            <label class="form-label">Index Name</label>
                            <input type="text" class="form-control" id="alterIndexName" placeholder="e.g., idx_email">
                        </div>
                    `;
                    break;
            }
            
            alterFields.innerHTML = fieldsHTML;
        }
        
        function toggleAlterLengthField() {
            const typeSelect = document.getElementById('alterColumnType');
            const lengthSection = document.getElementById('alterLengthSection');
            
            if (lengthApplicableTypes.includes(typeSelect.value)) {
                lengthSection.classList.remove('hidden');
            } else {
                lengthSection.classList.add('hidden');
            }
        }
        
        function toggleAlterForeignKey() {
            const foreignKeyCheckbox = document.getElementById('alterForeign');
            const foreignKeySection = document.getElementById('alterForeignKeySection');
            
            if (foreignKeyCheckbox.checked) {
                foreignKeySection.classList.remove('hidden');
            } else {
                foreignKeySection.classList.add('hidden');
            }
        }
        
        // Query generation
        function generateQuery(event, isAlter) {
            event.preventDefault();
            
            const tableName = document.getElementById('tableName').value;
            
            if (!tableName) {
                document.getElementById('tableNameError').textContent = 'Table name is required';
                return;
            }
            
            let query = '';
            
            if (isAlter) {
                const action = document.getElementById('alterAction').value;
                
                if (!action) {
                    showToast('Please select an action', 'error');
                    return;
                }
                
                query = generateAlterQuery(action, tableName);
            } else {
                query = generateCreateQuery(tableName);
            }
            
            // Display the query
            displayQuery(query);
            
            // Save to history
            saveToHistory(query);
        }
        
        function generateCreateQuery(tableName) {
            const engine = document.getElementById('engine').value;
            const charset = document.getElementById('charset').value;
            const collation = document.getElementById('collation').value;
            const tableDescription = document.getElementById('tableDescription').value;
            
            let query = `CREATE TABLE \`${tableName}\` (\n`;
            
            // Get all columns
            const columns = [];
            const primaryKeys = [];
            const uniqueKeys = [];
            const foreignKeys = [];
            
            for (let i = 0; i < columnCount; i++) {
                const columnElement = document.getElementById(`column-${i}`);
                if (!columnElement) continue;
                
                const name = document.getElementById(`columnName${i}`).value;
                const type = document.getElementById(`columnType${i}`).value;
                const length = document.getElementById(`columnLength${i}`).value;
                const enumValues = document.getElementById(`columnEnum${i}`).value;
                const defaultValue = document.getElementById(`columnDefault${i}`).value;
                const comment = document.getElementById(`columnComment${i}`).value;
                
                if (!name || !type) continue;
                
                let columnDef = `  \`${name}\` ${type}`;
                
                // Add length/precision
                if (type === 'ENUM' || type === 'SET') {
                    if (enumValues) {
                        columnDef += `(${enumValues})`;
                    }
                } else if (lengthApplicableTypes.includes(type) && length) {
                    columnDef += `(${length})`;
                }
                
                // Add constraints
                if (document.getElementById(`columnUnsigned${i}`).checked) {
                    columnDef += ` UNSIGNED`;
                }
                
                if (document.getElementById(`columnNotNull${i}`).checked) {
                    columnDef += ` NOT NULL`;
                }
                
                if (defaultValue) {
                    if (defaultValue.toLowerCase() === 'null') {
                        columnDef += ` DEFAULT NULL`;
                    } else if (stringTypes.includes(type) || type === 'DATE' || type === 'DATETIME' || type === 'TIMESTAMP') {
                        columnDef += ` DEFAULT '${defaultValue}'`;
                    } else {
                        columnDef += ` DEFAULT ${defaultValue}`;
                    }
                }
                
                if (document.getElementById(`columnAutoIncrement${i}`).checked) {
                    columnDef += ` AUTO_INCREMENT`;
                }
                
                if (comment) {
                    columnDef += ` COMMENT '${comment}'`;
                }
                
                columns.push(columnDef);
                
                // Track constraints
                if (document.getElementById(`columnPrimary${i}`).checked) {
                    primaryKeys.push(name);
                }
                
                if (document.getElementById(`columnUnique${i}`).checked && !document.getElementById(`columnPrimary${i}`).checked) {
                    uniqueKeys.push(name);
                }
                
                if (document.getElementById(`columnForeign${i}`).checked) {
                    const fkTable = document.getElementById(`columnFkTable${i}`).value;
                    const fkColumn = document.getElementById(`columnFkColumn${i}`).value;
                    const fkOnDelete = document.getElementById(`columnFkOnDelete${i}`).value;
                    const fkOnUpdate = document.getElementById(`columnFkOnUpdate${i}`).value;
                    
                    if (fkTable && fkColumn) {
                        const constraintName = `fk_${tableName}_${name}`;
                        foreignKeys.push(`  CONSTRAINT \`${constraintName}\` FOREIGN KEY (\`${name}\`) REFERENCES \`${fkTable}\` (\`${fkColumn}\`) ON DELETE ${fkOnDelete} ON UPDATE ${fkOnUpdate}`);
                    }
                }
            }
            
            // Add columns to query
            query += columns.join(',\n');
            
            // Add primary key
            if (primaryKeys.length > 0) {
                query += `,\n  PRIMARY KEY (\`${primaryKeys.join('`, `')}\`)`;
            }
            
            // Add unique keys
            uniqueKeys.forEach(key => {
                query += `,\n  UNIQUE KEY \`uniq_${tableName}_${key}\` (\`${key}\`)`;
            });
            
            // Add foreign keys
            foreignKeys.forEach(fk => {
                query += `,\n${fk}`;
            });
            
            // Add table comment if provided
            if (tableDescription) {
                query += `,\n  COMMENT '${tableDescription}'`;
            }
            
            query += `\n) ENGINE=${engine} DEFAULT CHARSET=${charset} COLLATE=${collation};`;
            
            return query;
        }
        
        function generateAlterQuery(action, tableName) {
            let query = `ALTER TABLE \`${tableName}\` `;
            
            switch (action) {
                case 'ADD':
                case 'MODIFY':
                    const columnName = document.getElementById('alterColumnName').value;
                    const columnType = document.getElementById('alterColumnType').value;
                    const columnLength = document.getElementById('alterColumnLength').value;
                    const columnDefault = document.getElementById('alterColumnDefault').value;
                    
                    if (!columnName || !columnType) {
                        showToast('Column name and type are required', 'error');
                        return '';
                    }
                    
                    let columnDef = `\`${columnName}\` ${columnType}`;
                    
                    if (lengthApplicableTypes.includes(columnType) && columnLength) {
                        columnDef += `(${columnLength})`;
                    }
                    
                    if (document.getElementById('alterNotNull').checked) {
                        columnDef += ` NOT NULL`;
                    }
                    
                    if (columnDefault) {
                        if (columnDefault.toLowerCase() === 'null') {
                            columnDef += ` DEFAULT NULL`;
                        } else if (stringTypes.includes(columnType) || dateTypes.includes(columnType)) {
                            columnDef += ` DEFAULT '${columnDefault}'`;
                        } else {
                            columnDef += ` DEFAULT ${columnDefault}`;
                        }
                    }
                    
                    if (document.getElementById('alterAutoIncrement').checked) {
                        columnDef += ` AUTO_INCREMENT`;
                    }
                    
                    query += action === 'ADD' ? `ADD COLUMN ${columnDef}` : `MODIFY COLUMN ${columnDef}`;
                    
                    // Add constraints separately
                    if (document.getElementById('alterPrimary').checked) {
                        query += `, ADD PRIMARY KEY (\`${columnName}\`)`;
                    }
                    
                    if (document.getElementById('alterUnique').checked && !document.getElementById('alterPrimary').checked) {
                        query += `, ADD UNIQUE KEY \`uniq_${tableName}_${columnName}\` (\`${columnName}\`)`;
                    }
                    
                    if (document.getElementById('alterForeign').checked) {
                        const fkTable = document.getElementById('alterFkTable').value;
                        const fkColumn = document.getElementById('alterFkColumn').value;
                        const fkOnDelete = document.getElementById('alterFkOnDelete').value;
                        const fkOnUpdate = document.getElementById('alterFkOnUpdate').value;
                        
                        if (fkTable && fkColumn) {
                            const constraintName = `fk_${tableName}_${columnName}`;
                            query += `, ADD CONSTRAINT \`${constraintName}\` FOREIGN KEY (\`${columnName}\`) REFERENCES \`${fkTable}\` (\`${fkColumn}\`) ON DELETE ${fkOnDelete} ON UPDATE ${fkOnUpdate}`;
                        }
                    }
                    break;
                    
                case 'DROP':
                    const dropColumnName = document.getElementById('alterColumnName').value;
                    if (!dropColumnName) {
                        showToast('Column name is required', 'error');
                        return '';
                    }
                    query += `DROP COLUMN \`${dropColumnName}\``;
                    break;
                    
                case 'ADD_FK':
                    const fkColumnName = document.getElementById('alterColumnName').value;
                    const fkName = document.getElementById('alterFkName').value;
                    const fkRefTable = document.getElementById('alterFkTable').value;
                    const fkRefColumn = document.getElementById('alterFkColumn').value;
                    const fkOnDelete = document.getElementById('alterFkOnDelete').value;
                    const fkOnUpdate = document.getElementById('alterFkOnUpdate').value;
                    
                    if (!fkColumnName || !fkRefTable || !fkRefColumn) {
                        showToast('Column name, reference table and column are required', 'error');
                        return '';
                    }
                    
                    const constraintName = fkName || `fk_${tableName}_${fkColumnName}`;
                    query += `ADD CONSTRAINT \`${constraintName}\` FOREIGN KEY (\`${fkColumnName}\`) REFERENCES \`${fkRefTable}\` (\`${fkRefColumn}\`) ON DELETE ${fkOnDelete} ON UPDATE ${fkOnUpdate}`;
                    break;
                    
                case 'DROP_FK':
                    const dropFkName = document.getElementById('alterFkName').value;
                    if (!dropFkName) {
                        showToast('Constraint name is required', 'error');
                        return '';
                    }
                    query += `DROP FOREIGN KEY \`${dropFkName}\``;
                    break;
                    
                case 'ADD_INDEX':
                    const indexName = document.getElementById('alterIndexName').value;
                    const indexType = document.getElementById('alterIndexType').value;
                    const indexColumns = document.getElementById('alterIndexColumns').value;
                    
                    if (!indexName || !indexColumns) {
                        showToast('Index name and columns are required', 'error');
                        return '';
                    }
                    
                    query += `ADD ${indexType} \`${indexName}\` (\`${indexColumns.replace(/,/g, '`, `')}\`)`;
                    break;
                    
                case 'DROP_INDEX':
                    const dropIndexName = document.getElementById('alterIndexName').value;
                    if (!dropIndexName) {
                        showToast('Index name is required', 'error');
                        return '';
                    }
                    query += `DROP INDEX \`${dropIndexName}\``;
                    break;
            }
            
            query += ';';
            return query;
        }
        
        function generateIndexesQuery() {
            const tableName = document.getElementById('tableName').value;
            
            if (!tableName) {
                showToast('Table name is required', 'error');
                return;
            }
            
            let query = '';
            
            for (let i = 0; i < indexCount; i++) {
                const indexElement = document.getElementById(`index-${i}`);
                if (!indexElement) continue;
                
                const name = document.getElementById(`indexName${i}`).value;
                const type = document.getElementById(`indexType${i}`).value;
                const columns = document.getElementById(`indexColumns${i}`).value;
                
                if (!name || !columns) continue;
                
                if (query) query += '\n';
                query += `ALTER TABLE \`${tableName}\` ADD ${type} \`${name}\` (\`${columns.replace(/,/g, '`, `')}\`);`;
            }
            
            if (!query) {
                showToast('No indexes defined', 'error');
                return;
            }
            
            displayQuery(query);
            saveToHistory(query);
        }
        
        function generateRelationshipsQuery() {
            const tableName = document.getElementById('tableName').value;
            
            if (!tableName) {
                showToast('Table name is required', 'error');
                return;
            }
            
            let query = '';
            
            for (let i = 0; i < relationshipCount; i++) {
                const relationshipElement = document.getElementById(`relationship-${i}`);
                if (!relationshipElement) continue;
                
                const sourceTable = document.getElementById(`relSourceTable${i}`).value;
                const sourceColumn = document.getElementById(`relSourceColumn${i}`).value;
                const targetTable = document.getElementById(`relTargetTable${i}`).value;
                const targetColumn = document.getElementById(`relTargetColumn${i}`).value;
                const constraintName = document.getElementById(`relConstraintName${i}`).value;
                
                if (!sourceTable || !sourceColumn || !targetTable || !targetColumn) continue;
                
                if (query) query += '\n';
                query += `ALTER TABLE \`${targetTable}\` ADD CONSTRAINT \`${constraintName || `fk_${targetTable}_${targetColumn}`}\` FOREIGN KEY (\`${targetColumn}\`) REFERENCES \`${sourceTable}\` (\`${sourceColumn}\`);`;
            }
            
            if (!query) {
                showToast('No relationships defined', 'error');
                return;
            }
            
            displayQuery(query);
            saveToHistory(query);
        }
        
        function displayQuery(query) {
            const queryOutput = document.getElementById('queryOutput');
            const queryCode = document.getElementById('queryCode');
            
            queryOutput.classList.remove('hidden');
            queryCode.textContent = query;
            
            // Scroll to query output
            queryOutput.scrollIntoView({ behavior: 'smooth' });
            
            // Highlight syntax
            Prism.highlightElement(queryCode);
        }
        
        function formatQuery() {
            const queryCode = document.getElementById('queryCode');
            const query = queryCode.textContent;
            
            try {
                const formatted = sqlFormatter.format(query);
                queryCode.textContent = formatted;
                Prism.highlightElement(queryCode);
                showToast('Query formatted', 'success');
            } catch (error) {
                showToast('Failed to format query', 'error');
            }
        }
        
        function copyQuery() {
            const queryCode = document.getElementById('queryCode');
            const query = queryCode.textContent;
            
            navigator.clipboard.writeText(query).then(() => {
                showToast('Query copied to clipboard', 'success');
            }).catch(() => {
                showToast('Failed to copy query', 'error');
            });
        }
        
        function executeQuery() {
            // This would normally connect to a database and execute the query
            // For demo purposes, we'll just show a success message
            showToast('Query executed successfully (demo mode)', 'success');
        }
        
        // ORM Code Generation
        function updateORMCode() {
            const framework = document.getElementById('ormFramework').value;
            const tableName = document.getElementById('tableName').value;
            const ormCode = document.getElementById('ormCode');
            
            if (!tableName) {
                ormCode.textContent = '// Please enter a table name first';
                return;
            }
            
            let code = '';
            
            // Get columns
            const columns = [];
            for (let i = 0; i < columnCount; i++) {
                const columnElement = document.getElementById(`column-${i}`);
                if (!columnElement) continue;
                
                const name = document.getElementById(`columnName${i}`).value;
                const type = document.getElementById(`columnType${i}`).value;
                const notNull = document.getElementById(`columnNotNull${i}`).checked;
                const primary = document.getElementById(`columnPrimary${i}`).checked;
                const unique = document.getElementById(`columnUnique${i}`).checked;
                const autoIncrement = document.getElementById(`columnAutoIncrement${i}`).checked;
                const defaultValue = document.getElementById(`columnDefault${i}`).value;
                
                if (!name || !type) continue;
                
                columns.push({
                    name,
                    type,
                    notNull,
                    primary,
                    unique,
                    autoIncrement,
                    defaultValue
                });
            }
            
            switch (framework) {
                case 'sequelize':
                    code = generateSequelizeCode(tableName, columns);
                    break;
                case 'typeorm':
                    code = generateTypeORMCode(tableName, columns);
                    break;
                case 'eloquent':
                    code = generateEloquentCode(tableName, columns);
                    break;
                case 'sqlalchemy':
                    code = generateSQLAlchemyCode(tableName, columns);
                    break;
                case 'activerecord':
                    code = generateActiveRecordCode(tableName, columns);
                    break;
                case 'gorm':
                    code = generateGORMCode(tableName, columns);
                    break;
            }
            
            ormCode.textContent = code;
            Prism.highlightElement(ormCode);
        }
        
        function generateSequelizeCode(tableName, columns) {
            const modelName = toPascalCase(tableName);
            let code = `const { DataTypes } = require('sequelize');
const sequelize = require('../config/database');

const ${modelName} = sequelize.define('${tableName}', {
`;
            
            columns.forEach(col => {
                let type = '';
                
                switch (col.type) {
                    case 'INT':
                    case 'BIGINT':
                    case 'SMALLINT':
                    case 'TINYINT':
                        type = col.type === 'BIGINT' ? 'DataTypes.BIGINT' : 'DataTypes.INTEGER';
                        break;
                    case 'VARCHAR':
                    case 'CHAR':
                        type = 'DataTypes.STRING';
                        break;
                    case 'TEXT':
                    case 'LONGTEXT':
                    case 'MEDIUMTEXT':
                    case 'TINYTEXT':
                        type = 'DataTypes.TEXT';
                        break;
                    case 'DECIMAL':
                    case 'FLOAT':
                    case 'DOUBLE':
                        type = col.type === 'DECIMAL' ? 'DataTypes.DECIMAL' : 'DataTypes.FLOAT';
                        break;
                    case 'BOOLEAN':
                        type = 'DataTypes.BOOLEAN';
                        break;
                    case 'DATE':
                        type = 'DataTypes.DATEONLY';
                        break;
                    case 'DATETIME':
                    case 'TIMESTAMP':
                        type = 'DataTypes.DATE';
                        break;
                    case 'JSON':
                        type = 'DataTypes.JSON';
                        break;
                    case 'ENUM':
                        type = 'DataTypes.ENUM';
                        break;
                    default:
                        type = 'DataTypes.STRING';
                }
                
                code += `  ${col.name}: {
    type: ${type}`;
                
                if (col.notNull) {
                    code += `,
    allowNull: false`;
                }
                
                if (col.primary) {
                    code += `,
    primaryKey: true`;
                }
                
                if (col.autoIncrement) {
                    code += `,
    autoIncrement: true`;
                }
                
                if (col.unique) {
                    code += `,
    unique: true`;
                }
                
                if (col.defaultValue) {
                    if (col.defaultValue.toLowerCase() === 'null') {
                        code += `,
    defaultValue: null`;
                    } else if (col.type === 'VARCHAR' || col.type === 'CHAR' || col.type === 'TEXT' || col.type === 'DATE' || col.type === 'DATETIME') {
                        code += `,
    defaultValue: '${col.defaultValue}'`;
                    } else {
                        code += `,
    defaultValue: ${col.defaultValue}`;
                    }
                }
                
                code += `
  },\n`;
            });
            
            code += `}, {
  tableName: '${tableName}',
  timestamps: true
});

module.exports = ${modelName};`;
            
            return code;
        }
        
        function generateTypeORMCode(tableName, columns) {
            const modelName = toPascalCase(tableName);
            let code = `import { Entity, PrimaryGeneratedColumn, Column, CreateDateColumn, UpdateDateColumn } from 'typeorm';

@Entity('${tableName}')
export class ${modelName} {
`;
            
            columns.forEach(col => {
                if (col.primary && col.autoIncrement) {
                    code += `  @PrimaryGeneratedColumn()\n  ${col.name}: ${getTypeScriptType(col.type)};\n\n`;
                } else {
                    code += `  @Column({\n`;
                    
                    if (col.type === 'VARCHAR' || col.type === 'CHAR') {
                        code += `    type: 'varchar'`;
                    } else if (col.type === 'TEXT' || col.type === 'LONGTEXT' || col.type === 'MEDIUMTEXT' || col.type === 'TINYTEXT') {
                        code += `    type: 'text'`;
                    } else if (col.type === 'INT' || col.type === 'BIGINT' || col.type === 'SMALLINT' || col.type === 'TINYINT') {
                        code += `    type: '${col.type.toLowerCase()}'`;
                    } else if (col.type === 'DECIMAL' || col.type === 'FLOAT' || col.type === 'DOUBLE') {
                        code += `    type: '${col.type.toLowerCase()}'`;
                    } else if (col.type === 'BOOLEAN') {
                        code += `    type: 'boolean'`;
                    } else if (col.type === 'DATE') {
                        code += `    type: 'date'`;
                    } else if (col.type === 'DATETIME' || col.type === 'TIMESTAMP') {
                        code += `    type: 'datetime'`;
                    } else if (col.type === 'JSON') {
                        code += `    type: 'json'`;
                    } else if (col.type === 'ENUM') {
                        code += `    type: 'enum'`;
                    } else {
                        code += `    type: 'varchar'`;
                    }
                    
                    if (col.notNull) {
                        code += `,\n    nullable: false`;
                    }
                    
                    if (col.unique) {
                        code += `,\n    unique: true`;
                    }
                    
                    if (col.defaultValue) {
                        if (col.defaultValue.toLowerCase() === 'null') {
                            code += `,\n    default: null`;
                        } else if (col.type === 'VARCHAR' || col.type === 'CHAR' || col.type === 'TEXT' || col.type === 'DATE' || col.type === 'DATETIME') {
                            code += `,\n    default: '${col.defaultValue}'`;
                        } else {
                            code += `,\n    default: ${col.defaultValue}`;
                        }
                    }
                    
                    code += `\n  })\n  ${col.name}: ${getTypeScriptType(col.type)};\n\n`;
                }
            });
            
            code += `  @CreateDateColumn()
  createdAt: Date;

  @UpdateDateColumn()
  updatedAt: Date;
}`;
            
            return code;
        }
        
        function generateEloquentCode(tableName, columns) {
            const modelName = toPascalCase(tableName);
            let code = `<?php

namespace App\\Models;

use Illuminate\\Database\\Eloquent\\Factories\\HasFactory;
use Illuminate\\Database\\Eloquent\\Model;

class ${modelName} extends Model
{
    use HasFactory;
    
    protected $table = '${tableName}';
`;
            
            const fillable = [];
            const hidden = [];
            const casts = [];
            
            columns.forEach(col => {
                if (!col.primary && !col.autoIncrement) {
                    fillable.push(`'${col.name}'`);
                }
                
                if (col.type === 'JSON') {
                    casts.push(`'${col.name}' => 'array'`);
                } else if (col.type === 'BOOLEAN') {
                    casts.push(`'${col.name}' => 'boolean'`);
                } else if (col.type === 'DATETIME' || col.type === 'TIMESTAMP') {
                    casts.push(`'${col.name}' => 'datetime'`);
                } else if (col.type === 'DATE') {
                    casts.push(`'${col.name}' => 'date'`);
                }
            });
            
            if (fillable.length > 0) {
                code += `\n    protected $fillable = [\n        ${fillable.join(',\n        ')}\n    ];`;
            }
            
            if (hidden.length > 0) {
                code += `\n\n    protected $hidden = [\n        ${hidden.join(',\n        ')}\n    ];`;
            }
            
            if (casts.length > 0) {
                code += `\n\n    protected $casts = [\n        ${casts.join(',\n        ')}\n    ];`;
            }
            
            code += `\n}`;
            
            return code;
        }
        
        function generateSQLAlchemyCode(tableName, columns) {
            const modelName = toPascalCase(tableName);
            let code = `from sqlalchemy import Column, Integer, String, Text, Boolean, DateTime, Date, Float, JSON
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.sql import func

Base = declarative_base()

class ${modelName}(Base):
    __tablename__ = '${tableName}'
`;
            
            columns.forEach(col => {
                let type = '';
                
                switch (col.type) {
                    case 'INT':
                    case 'BIGINT':
                    case 'SMALLINT':
                    case 'TINYINT':
                        type = 'Integer';
                        break;
                    case 'VARCHAR':
                    case 'CHAR':
                        type = 'String';
                        break;
                    case 'TEXT':
                    case 'LONGTEXT':
                    case 'MEDIUMTEXT':
                    case 'TINYTEXT':
                        type = 'Text';
                        break;
                    case 'DECIMAL':
                    case 'FLOAT':
                    case 'DOUBLE':
                        type = 'Float';
                        break;
                    case 'BOOLEAN':
                        type = 'Boolean';
                        break;
                    case 'DATE':
                        type = 'Date';
                        break;
                    case 'DATETIME':
                    case 'TIMESTAMP':
                        type = 'DateTime';
                        break;
                    case 'JSON':
                        type = 'JSON';
                        break;
                    default:
                        type = 'String';
                }
                
                if (col.primary && col.autoIncrement) {
                    code += `    ${col.name} = Column(${type}, primary_key=True, autoincrement=True)\n`;
                } else {
                    code += `    ${col.name} = Column(${type}`;
                    
                    if (col.notNull) {
                        code += `, nullable=False`;
                    }
                    
                    if (col.unique) {
                        code += `, unique=True`;
                    }
                    
                    if (col.defaultValue) {
                        if (col.defaultValue.toLowerCase() === 'null') {
                            code += `, default=None`;
                        } else if (col.type === 'VARCHAR' || col.type === 'CHAR' || col.type === 'TEXT' || col.type === 'DATE' || col.type === 'DATETIME') {
                            code += `, default='${col.defaultValue}'`;
                        } else {
                            code += `, default=${col.defaultValue}`;
                        }
                    }
                    
                    code += `)\n`;
                }
            });
            
            code += `
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())`;
            
            return code;
        }
        
        function generateActiveRecordCode(tableName, columns) {
            const modelName = toPascalCase(tableName);
            let code = `class ${modelName} < ApplicationRecord
  self.table_name = '${tableName}'
`;
            
            columns.forEach(col => {
                if (col.type === 'DECIMAL' || col.type === 'FLOAT' || col.type === 'DOUBLE') {
                    code += `  validates :${col.name}, numericality: true\n`;
                }
                
                if (col.notNull && !col.primary && !col.autoIncrement) {
                    code += `  validates :${col.name}, presence: true\n`;
                }
                
                if (col.unique) {
                    code += `  validates :${col.name}, uniqueness: true\n`;
                }
            });
            
            return code;
        }
        
        function generateGORMCode(tableName, columns) {
            const modelName = toPascalCase(tableName);
            let code = `package models

import (
    "time"
    "gorm.io/gorm"
)
`;
            
            columns.forEach(col => {
                let type = '';
                
                switch (col.type) {
                    case 'INT':
                    case 'BIGINT':
                    case 'SMALLINT':
                    case 'TINYINT':
                        type = 'int';
                        break;
                    case 'VARCHAR':
                    case 'CHAR':
                    case 'TEXT':
                    case 'LONGTEXT':
                    case 'MEDIUMTEXT':
                    case 'TINYTEXT':
                        type = 'string';
                        break;
                    case 'DECIMAL':
                    case 'FLOAT':
                    case 'DOUBLE':
                        type = 'float64';
                        break;
                    case 'BOOLEAN':
                        type = 'bool';
                        break;
                    case 'DATE':
                    case 'DATETIME':
                    case 'TIMESTAMP':
                        type = 'time.Time';
                        break;
                    case 'JSON':
                        type = 'string'; // GORM doesn't have native JSON type
                        break;
                    default:
                        type = 'string';
                }
                
                code += `type ${modelName} struct {
    gorm.Model
`;
                
                columns.forEach(col => {
                    code += `    ${toPascalCase(col.name)} ${type} \`gorm:"`;
                    
                    if (col.primary) {
                        code += `primaryKey`;
                    }
                    
                    if (col.autoIncrement) {
                        code += `;autoIncrement`;
                    }
                    
                    if (col.notNull) {
                        code += `;not null`;
                    }
                    
                    if (col.unique) {
                        code += `;unique`;
                    }
                    
                    if (col.defaultValue) {
                        code += `;default:${col.defaultValue}`;
                    }
                    
                    code += `"\`\n`;
                });
                
                code += `    CreatedAt time.Time
    UpdatedAt time.Time
    DeletedAt gorm.DeletedAt \`gorm:"index"\`
}
`;
            });
            
            return code;
        }
        
        function getTypeScriptType(mysqlType) {
            switch (mysqlType) {
                case 'INT':
                case 'BIGINT':
                case 'SMALLINT':
                case 'TINYINT':
                    return 'number';
                case 'VARCHAR':
                case 'CHAR':
                case 'TEXT':
                case 'LONGTEXT':
                case 'MEDIUMTEXT':
                case 'TINYTEXT':
                    return 'string';
                case 'DECIMAL':
                case 'FLOAT':
                case 'DOUBLE':
                    return 'number';
                case 'BOOLEAN':
                    return 'boolean';
                case 'DATE':
                case 'DATETIME':
                case 'TIMESTAMP':
                    return 'Date';
                case 'JSON':
                    return 'any';
                default:
                    return 'any';
            }
        }
        
        function toPascalCase(str) {
            return str.replace(/(?:^|_)([a-z])/g, (_, char) => char.toUpperCase());
        }
        
        function copyORMCode() {
            const ormCode = document.getElementById('ormCode');
            const code = ormCode.textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                showToast('Code copied to clipboard', 'success');
            }).catch(() => {
                showToast('Failed to copy code', 'error');
            });
        }
        
        // History management
        function saveToHistory(query) {
            const tableName = document.getElementById('tableName').value;
            const timestamp = new Date().toISOString();
            
            const historyItem = {
                id: Date.now(),
                tableName,
                query,
                timestamp,
                tab: currentTab
            };
            
            queryHistory.unshift(historyItem);
            
            // Keep only the last 50 items
            if (queryHistory.length > 50) {
                queryHistory = queryHistory.slice(0, 50);
            }
            
            // Save to localStorage
            localStorage.setItem('mysqlStudioHistory', JSON.stringify(queryHistory));
            
            showToast('Query saved to history', 'success');
        }
        
        function showHistoryModal() {
            const historyList = document.getElementById('historyList');
            
            if (queryHistory.length === 0) {
                historyList.innerHTML = '<p class="text-gray-400">No history yet</p>';
            } else {
                historyList.innerHTML = '';
                
                queryHistory.forEach(item => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <div class="history-item-title">${item.tableName} - ${item.tab}</div>
                        <div class="history-item-date">${new Date(item.timestamp).toLocaleString()}</div>
                        <div class="mt-2">
                            <button class="btn btn-secondary btn-sm" onclick="loadFromHistory(${item.id})">
                                <i class="fas fa-folder-open mr-1"></i> Load
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="deleteFromHistory(${item.id})">
                                <i class="fas fa-trash mr-1"></i> Delete
                            </button>
                        </div>
                    `;
                    historyList.appendChild(historyItem);
                });
            }
            
            showModal('historyModal');
        }
        
        function loadFromHistory(id) {
            const historyItem = queryHistory.find(item => item.id === id);
            
            if (historyItem) {
                document.getElementById('tableName').value = historyItem.tableName;
                displayQuery(historyItem.query);
                closeModal('historyModal');
                showToast('Query loaded from history', 'success');
            }
        }
        
        function deleteFromHistory(id) {
            queryHistory = queryHistory.filter(item => item.id !== id);
            localStorage.setItem('mysqlStudioHistory', JSON.stringify(queryHistory));
            showHistoryModal(); // Refresh the modal
            showToast('Item deleted from history', 'info');
        }
        
        // Import/Export functionality
        function showImportModal() {
            updateImportOptions();
            showModal('importModal');
        }
        
        function updateImportOptions() {
            const source = document.getElementById('importSource').value;
            const importOptions = document.getElementById('importOptions');
            
            let optionsHTML = '';
            
            switch (source) {
                case 'sql':
                case 'json':
                case 'yaml':
                    optionsHTML = `
                        <div class="mb-4">
                            <label class="form-label">File Content</label>
                            <textarea class="form-control w-full" rows="10" id="importContent" placeholder="Paste your ${source.toUpperCase()} content here"></textarea>
                        </div>
                    `;
                    break;
                case 'database':
                    optionsHTML = `
                        <div class="mb-4">
                            <label class="form-label">Connection String</label>
                            <input type="text" class="form-control w-full" id="dbConnectionString" placeholder="mysql://user:password@host:port/database">
                        </div>
                        <div class="mb-4">
                            <label class="form-label">Table Name</label>
                            <input type="text" class="form-control w-full" id="dbTableName" placeholder="Table to import">
                        </div>
                    `;
                    break;
            }
            
            importOptions.innerHTML = optionsHTML;
        }
        
        function importTableStructure() {
            const source = document.getElementById('importSource').value;
            
            switch (source) {
                case 'sql':
                    importFromSQL();
                    break;
                case 'json':
                    importFromJSON();
                    break;
                case 'yaml':
                    importFromYAML();
                    break;
                case 'database':
                    importFromDatabase();
                    break;
            }
        }
        
        function importFromSQL() {
            const content = document.getElementById('importContent').value;
            
            if (!content) {
                showToast('Please provide SQL content', 'error');
                return;
            }
            
            // This is a simplified parser for demo purposes
            // In a real app, you'd use a proper SQL parser
            const createTableMatch = content.match(/CREATE TABLE `?(\w+)`? \(([\s\S]+?)\)[\s\S]*?;/i);
            
            if (createTableMatch) {
                const tableName = createTableMatch[1];
                const columnsText = createTableMatch[2];
                
                document.getElementById('tableName').value = tableName;
                
                // Clear existing columns
                document.getElementById('columns').innerHTML = '';
                columnCount = 0;
                
                // Parse columns (simplified)
                const columnLines = columnsText.split(',').map(line => line.trim()).filter(line => line);
                
                columnLines.forEach(line => {
                    const columnMatch = line.match(/^`?(\w+)`? (\w+)(?:\(([^)]+)\))?/);
                    
                    if (columnMatch) {
                        const columnName = columnMatch[1];
                        const columnType = columnMatch[2];
                        const columnLength = columnMatch[3];
                        
                        addColumn();
                        const index = columnCount - 1;
                        
                        document.getElementById(`columnName${index}`).value = columnName;
                        document.getElementById(`columnType${index}`).value = columnType;
                        
                        if (columnLength) {
                            document.getElementById(`columnLength${index}`).value = columnLength;
                            toggleLengthField(index);
                        }
                        
                        // Check for constraints (simplified)
                        if (line.includes('PRIMARY KEY')) {
                            document.getElementById(`columnPrimary${index}`).checked = true;
                        }
                        
                        if (line.includes('NOT NULL')) {
                            document.getElementById(`columnNotNull${index}`).checked = true;
                        }
                        
                        if (line.includes('AUTO_INCREMENT')) {
                            document.getElementById(`columnAutoIncrement${index}`).checked = true;
                        }
                        
                        if (line.includes('UNIQUE')) {
                            document.getElementById(`columnUnique${index}`).checked = true;
                        }
                    }
                });
                
                closeModal('importModal');
                showToast('Table structure imported successfully', 'success');
            } else {
                showToast('Could not parse SQL content', 'error');
            }
        }
        
        function importFromJSON() {
            const content = document.getElementById('importContent').value;
            
            if (!content) {
                showToast('Please provide JSON content', 'error');
                return;
            }
            
            try {
                const data = JSON.parse(content);
                
                if (data.tableName) {
                    document.getElementById('tableName').value = data.tableName;
                }
                
                if (data.description) {
                    document.getElementById('tableDescription').value = data.description;
                }
                
                if (data.columns && Array.isArray(data.columns)) {
                    // Clear existing columns
                    document.getElementById('columns').innerHTML = '';
                    columnCount = 0;
                    
                    data.columns.forEach(col => {
                        addColumn();
                        const index = columnCount - 1;
                        
                        if (col.name) document.getElementById(`columnName${index}`).value = col.name;
                        if (col.type) document.getElementById(`columnType${index}`).value = col.type;
                        if (col.length) {
                            document.getElementById(`columnLength${index}`).value = col.length;
                            toggleLengthField(index);
                        }
                        if (col.default) document.getElementById(`columnDefault${index}`).value = col.default;
                        if (col.comment) document.getElementById(`columnComment${index}`).value = col.comment;
                        
                        if (col.primary) document.getElementById(`columnPrimary${index}`).checked = true;
                        if (col.unique) document.getElementById(`columnUnique${index}`).checked = true;
                        if (col.notNull) document.getElementById(`columnNotNull${index}`).checked = true;
                        if (col.autoIncrement) document.getElementById(`columnAutoIncrement${index}`).checked = true;
                        if (col.unsigned) document.getElementById(`columnUnsigned${index}`).checked = true;
                        
                        if (col.foreignKey) {
                            document.getElementById(`columnForeign${index}`).checked = true;
                            toggleForeignKey(index);
                            
                            if (col.foreignKey.table) document.getElementById(`columnFkTable${index}`).value = col.foreignKey.table;
                            if (col.foreignKey.column) document.getElementById(`columnFkColumn${index}`).value = col.foreignKey.column;
                            if (col.foreignKey.onDelete) document.getElementById(`columnFkOnDelete${index}`).value = col.foreignKey.onDelete;
                            if (col.foreignKey.onUpdate) document.getElementById(`columnFkOnUpdate${index}`).value = col.foreignKey.onUpdate;
                        }
                    });
                }
                
                if (data.indexes && Array.isArray(data.indexes)) {
                    // Clear existing indexes
                    document.getElementById('indexes').innerHTML = '';
                    indexCount = 0;
                    
                    data.indexes.forEach(idx => {
                        addIndex();
                        const index = indexCount - 1;
                        
                        if (idx.name) document.getElementById(`indexName${index}`).value = idx.name;
                        if (idx.type) document.getElementById(`indexType${index}`).value = idx.type;
                        if (idx.columns) document.getElementById(`indexColumns${index}`).value = idx.columns.join(',');
                    });
                }
                
                closeModal('importModal');
                showToast('Table structure imported successfully', 'success');
            } catch (error) {
                showToast('Invalid JSON content', 'error');
            }
        }
        
        function importFromYAML() {
            // Similar to JSON but with YAML parsing
            showToast('YAML import not implemented in this demo', 'info');
        }
        
        function importFromDatabase() {
            // This would connect to a database and fetch table structure
            showToast('Database import not implemented in this demo', 'info');
        }
        
        function showExportModal() {
            showModal('exportModal');
        }
        
        function exportTableStructure() {
            const format = document.getElementById('exportFormat').value;
            const includeData = document.getElementById('includeData').checked;
            const includeIndexes = document.getElementById('includeIndexes').checked;
            const includeConstraints = document.getElementById('includeConstraints').checked;
            const includeComments = document.getElementById('includeComments').checked;
            
            const tableName = document.getElementById('tableName').value;
            const tableDescription = document.getElementById('tableDescription').value;
            
            if (!tableName) {
                showToast('Table name is required', 'error');
                return;
            }
            
            let exportData = '';
            
            switch (format) {
                case 'sql':
                    exportData = exportToSQL(tableName, tableDescription, includeData, includeIndexes, includeConstraints, includeComments);
                    break;
                case 'json':
                    exportData = exportToJSON(tableName, tableDescription, includeData, includeIndexes, includeConstraints, includeComments);
                    break;
                case 'yaml':
                    exportData = exportToYAML(tableName, tableDescription, includeData, includeIndexes, includeConstraints, includeComments);
                    break;
                case 'markdown':
                    exportData = exportToMarkdown(tableName, tableDescription, includeData, includeIndexes, includeConstraints, includeComments);
                    break;
            }
            
            // Create a download link
            const blob = new Blob([exportData], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${tableName}_structure.${format}`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            closeModal('exportModal');
            showToast(`Table structure exported as ${format.toUpperCase()}`, 'success');
        }
        
        function exportToSQL(tableName, tableDescription, includeData, includeIndexes, includeConstraints, includeComments) {
            // Generate the CREATE TABLE query
            const query = generateCreateQuery(tableName);
            
            let exportData = query;
            
            if (includeData) {
                // Add sample INSERT statements (simplified)
                exportData += `\n\n-- Sample Data\nINSERT INTO \`${tableName}\` VALUES ();`;
            }
            
            return exportData;
        }
        
        function exportToJSON(tableName, tableDescription, includeData, includeIndexes, includeConstraints, includeComments) {
            const data = {
                tableName,
                description: tableDescription,
                columns: [],
                indexes: [],
                relationships: []
            };
            
            // Collect column data
            for (let i = 0; i < columnCount; i++) {
                const columnElement = document.getElementById(`column-${i}`);
                if (!columnElement) continue;
                
                const name = document.getElementById(`columnName${i}`).value;
                const type = document.getElementById(`columnType${i}`).value;
                const length = document.getElementById(`columnLength${i}`).value;
                const defaultValue = document.getElementById(`columnDefault${i}`).value;
                const comment = document.getElementById(`columnComment${i}`).value;
                
                if (!name || !type) continue;
                
                const column = {
                    name,
                    type,
                    length,
                    default: defaultValue,
                    comment,
                    primary: document.getElementById(`columnPrimary${i}`).checked,
                    unique: document.getElementById(`columnUnique${i}`).checked,
                    notNull: document.getElementById(`columnNotNull${i}`).checked,
                    autoIncrement: document.getElementById(`columnAutoIncrement${i}`).checked,
                    unsigned: document.getElementById(`columnUnsigned${i}`).checked
                };
                
                if (document.getElementById(`columnForeign${i}`).checked) {
                    column.foreignKey = {
                        table: document.getElementById(`columnFkTable${i}`).value,
                        column: document.getElementById(`columnFkColumn${i}`).value,
                        onDelete: document.getElementById(`columnFkOnDelete${i}`).value,
                        onUpdate: document.getElementById(`columnFkOnUpdate${i}`).value
                    };
                }
                
                data.columns.push(column);
            }
            
            // Collect index data
            if (includeIndexes) {
                for (let i = 0; i < indexCount; i++) {
                    const indexElement = document.getElementById(`index-${i}`);
                    if (!indexElement) continue;
                    
                    const name = document.getElementById(`indexName${i}`).value;
                    const type = document.getElementById(`indexType${i}`).value;
                    const columns = document.getElementById(`indexColumns${i}`).value;
                    
                    if (!name || !columns) continue;
                    
                    data.indexes.push({
                        name,
                        type,
                        columns: columns.split(',').map(col => col.trim())
                    });
                }
            }
            
            return JSON.stringify(data, null, 2);
        }
        
        function exportToYAML(tableName, tableDescription, includeData, includeIndexes, includeConstraints, includeComments) {
            // Similar to JSON but in YAML format
            const jsonData = exportToJSON(tableName, tableDescription, includeData, includeIndexes, includeConstraints, includeComments);
            const data = JSON.parse(jsonData);
            
            // Convert to YAML (simplified)
            let yaml = `tableName: ${data.tableName}\n`;
            
            if (data.description) {
                yaml += `description: ${data.description}\n`;
            }
            
            yaml += `columns:\n`;
            data.columns.forEach(col => {
                yaml += `  - name: ${col.name}\n`;
                yaml += `    type: ${col.type}\n`;
                
                if (col.length) yaml += `    length: ${col.length}\n`;
                if (col.default) yaml += `    default: ${col.default}\n`;
                if (col.comment) yaml += `    comment: ${col.comment}\n`;
                if (col.primary) yaml += `    primary: true\n`;
                if (col.unique) yaml += `    unique: true\n`;
                if (col.notNull) yaml += `    notNull: true\n`;
                if (col.autoIncrement) yaml += `    autoIncrement: true\n`;
                if (col.unsigned) yaml += `    unsigned: true\n`;
                
                if (col.foreignKey) {
                    yaml += `    foreignKey:\n`;
                    yaml += `      table: ${col.foreignKey.table}\n`;
                    yaml += `      column: ${col.foreignKey.column}\n`;
                    yaml += `      onDelete: ${col.foreignKey.onDelete}\n`;
                    yaml += `      onUpdate: ${col.foreignKey.onUpdate}\n`;
                }
            });
            
            if (includeIndexes && data.indexes.length > 0) {
                yaml += `indexes:\n`;
                data.indexes.forEach(idx => {
                    yaml += `  - name: ${idx.name}\n`;
                    yaml += `    type: ${idx.type}\n`;
                    yaml += `    columns: [${idx.columns.join(', ')}]\n`;
                });
            }
            
            return yaml;
        }
        
        function exportToMarkdown(tableName, tableDescription, includeData, includeIndexes, includeConstraints, includeComments) {
            let markdown = `# ${tableName}\n\n`;
            
            if (tableDescription) {
                markdown += `${tableDescription}\n\n`;
            }
            
            markdown += `## Columns\n\n`;
            markdown += `| Name | Type | Length | Default | Nullable | Primary | Unique | Auto Increment |\n`;
            markdown += `|------|------|--------|---------|----------|---------|--------|----------------|\n`;
            
            for (let i = 0; i < columnCount; i++) {
                const columnElement = document.getElementById(`column-${i}`);
                if (!columnElement) continue;
                
                const name = document.getElementById(`columnName${i}`).value;
                const type = document.getElementById(`columnType${i}`).value;
                const length = document.getElementById(`columnLength${i}`).value;
                const defaultValue = document.getElementById(`columnDefault${i}`).value;
                
                if (!name || !type) continue;
                
                const nullable = !document.getElementById(`columnNotNull${i}`).checked ? 'Yes' : 'No';
                const primary = document.getElementById(`columnPrimary${i}`).checked ? 'Yes' : 'No';
                const unique = document.getElementById(`columnUnique${i}`).checked ? 'Yes' : 'No';
                const autoIncrement = document.getElementById(`columnAutoIncrement${i}`).checked ? 'Yes' : 'No';
                
                markdown += `| ${name} | ${type} | ${length || '-'} | ${defaultValue || '-'} | ${nullable} | ${primary} | ${unique} | ${autoIncrement} |\n`;
            }
            
            if (includeIndexes) {
                markdown += `\n## Indexes\n\n`;
                markdown += `| Name | Type | Columns |\n`;
                markdown += `|------|------|---------|\n`;
                
                for (let i = 0; i < indexCount; i++) {
                    const indexElement = document.getElementById(`index-${i}`);
                    if (!indexElement) continue;
                    
                    const name = document.getElementById(`indexName${i}`).value;
                    const type = document.getElementById(`indexType${i}`).value;
                    const columns = document.getElementById(`indexColumns${i}`).value;
                    
                    if (!name || !columns) continue;
                    
                    markdown += `| ${name} | ${type} | ${columns} |\n`;
                }
            }
            
            return markdown;
        }
        
        // Template loading
        function showQuickActions() {
            showModal('quickActionsModal');
        }
        
        function loadTemplate(templateName) {
            // Clear existing columns
            document.getElementById('columns').innerHTML = '';
            columnCount = 0;
            
            switch (templateName) {
                case 'users':
                    document.getElementById('tableName').value = 'users';
                    document.getElementById('tableDescription').value = 'User accounts and authentication data';
                    
                    // ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnPrimary${columnCount - 1}`).checked = true;
                    document.getElementById(`columnAutoIncrement${columnCount - 1}`).checked = true;
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Username column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'username';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '50';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnique${columnCount - 1}`).checked = true;
                    
                    // Email column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'email';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '100';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnique${columnCount - 1}`).checked = true;
                    
                    // Password column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'password';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '255';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // First name column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'first_name';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '50';
                    toggleLengthField(columnCount - 1);
                    
                    // Last name column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'last_name';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '50';
                    toggleLengthField(columnCount - 1);
                    
                    // Created at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'created_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Updated at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'updated_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    break;
                    
                case 'products':
                    document.getElementById('tableName').value = 'products';
                    document.getElementById('tableDescription').value = 'Product catalog information';
                    
                    // ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnPrimary${columnCount - 1}`).checked = true;
                    document.getElementById(`columnAutoIncrement${columnCount - 1}`).checked = true;
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Name column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'name';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '255';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Description column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'description';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TEXT';
                    
                    // Price column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'price';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'DECIMAL';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '10,2';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnsigned${columnCount - 1}`).checked = true;
                    
                    // SKU column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'sku';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '100';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnique${columnCount - 1}`).checked = true;
                    
                    // Stock column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'stock';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'INT';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = '0';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnsigned${columnCount - 1}`).checked = true;
                    
                    // Category ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'category_id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnForeign${columnCount - 1}`).checked = true;
                    toggleForeignKey(columnCount - 1);
                    document.getElementById(`columnFkTable${columnCount - 1}`).value = 'categories';
                    document.getElementById(`columnFkColumn${columnCount - 1}`).value = 'id';
                    
                    // Created at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'created_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Updated at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'updated_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    break;
                    
                case 'orders':
                    document.getElementById('tableName').value = 'orders';
                    document.getElementById('tableDescription').value = 'Customer orders and transactions';
                    
                    // ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnPrimary${columnCount - 1}`).checked = true;
                    document.getElementById(`columnAutoIncrement${columnCount - 1}`).checked = true;
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // User ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'user_id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnForeign${columnCount - 1}`).checked = true;
                    toggleForeignKey(columnCount - 1);
                    document.getElementById(`columnFkTable${columnCount - 1}`).value = 'users';
                    document.getElementById(`columnFkColumn${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Order number column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'order_number';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '50';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnique${columnCount - 1}`).checked = true;
                    
                    // Status column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'status';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'ENUM';
                    document.getElementById(`columnEnum${columnCount - 1}`).value = "'pending','processing','shipped','delivered','cancelled'";
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'pending';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Total amount column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'total_amount';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'DECIMAL';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '10,2';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnsigned${columnCount - 1}`).checked = true;
                    
                    // Shipping address column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'shipping_address';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TEXT';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Order date column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'order_date';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'DATETIME';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Delivery date column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'delivery_date';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'DATETIME';
                    break;
                    
                case 'posts':
                    document.getElementById('tableName').value = 'posts';
                    document.getElementById('tableDescription').value = 'Blog posts and articles';
                    
                    // ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnPrimary${columnCount - 1}`).checked = true;
                    document.getElementById(`columnAutoIncrement${columnCount - 1}`).checked = true;
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Title column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'title';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '255';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Slug column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'slug';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '255';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnique${columnCount - 1}`).checked = true;
                    
                    // Content column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'content';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'LONGTEXT';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Excerpt column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'excerpt';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TEXT';
                    
                    // Author ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'author_id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnForeign${columnCount - 1}`).checked = true;
                    toggleForeignKey(columnCount - 1);
                    document.getElementById(`columnFkTable${columnCount - 1}`).value = 'users';
                    document.getElementById(`columnFkColumn${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Status column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'status';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'ENUM';
                    document.getElementById(`columnEnum${columnCount - 1}`).value = "'draft','published','archived'";
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'draft';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Published at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'published_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'DATETIME';
                    
                    // Created at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'created_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Updated at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'updated_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    break;
                    
                case 'categories':
                    document.getElementById('tableName').value = 'categories';
                    document.getElementById('tableDescription').value = 'Product or content categories';
                    
                    // ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnPrimary${columnCount - 1}`).checked = true;
                    document.getElementById(`columnAutoIncrement${columnCount - 1}`).checked = true;
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Name column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'name';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '100';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Slug column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'slug';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '100';
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnique${columnCount - 1}`).checked = true;
                    
                    // Description column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'description';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TEXT';
                    
                    // Parent ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'parent_id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnForeign${columnCount - 1}`).checked = true;
                    toggleForeignKey(columnCount - 1);
                    document.getElementById(`columnFkTable${columnCount - 1}`).value = 'categories';
                    document.getElementById(`columnFkColumn${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnFkOnDelete${columnCount - 1}`).value = 'CASCADE';
                    
                    // Sort order column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'sort_order';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'INT';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = '0';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnUnsigned${columnCount - 1}`).checked = true;
                    
                    // Is active column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'is_active';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BOOLEAN';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = '1';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Created at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'created_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Updated at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'updated_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    break;
                    
                case 'comments':
                    document.getElementById('tableName').value = 'comments';
                    document.getElementById('tableDescription').value = 'User comments on posts or products';
                    
                    // ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnPrimary${columnCount - 1}`).checked = true;
                    document.getElementById(`columnAutoIncrement${columnCount - 1}`).checked = true;
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Post ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'post_id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnForeign${columnCount - 1}`).checked = true;
                    toggleForeignKey(columnCount - 1);
                    document.getElementById(`columnFkTable${columnCount - 1}`).value = 'posts';
                    document.getElementById(`columnFkColumn${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnFkOnDelete${columnCount - 1}`).value = 'CASCADE';
                    
                    // User ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'user_id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnForeign${columnCount - 1}`).checked = true;
                    toggleForeignKey(columnCount - 1);
                    document.getElementById(`columnFkTable${columnCount - 1}`).value = 'users';
                    document.getElementById(`columnFkColumn${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    document.getElementById(`columnFkOnDelete${columnCount - 1}`).value = 'CASCADE';
                    
                    // Parent comment ID column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'parent_id';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'BIGINT';
                    document.getElementById(`columnForeign${columnCount - 1}`).checked = true;
                    toggleForeignKey(columnCount - 1);
                    document.getElementById(`columnFkTable${columnCount - 1}`).value = 'comments';
                    document.getElementById(`columnFkColumn${columnCount - 1}`).value = 'id';
                    document.getElementById(`columnFkOnDelete${columnCount - 1}`).value = 'CASCADE';
                    
                    // Content column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'content';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TEXT';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Status column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'status';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'ENUM';
                    document.getElementById(`columnEnum${columnCount - 1}`).value = "'pending','approved','rejected','spam'";
                    toggleLengthField(columnCount - 1);
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'pending';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // IP address column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'ip_address';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'VARCHAR';
                    document.getElementById(`columnLength${columnCount - 1}`).value = '45';
                    toggleLengthField(columnCount - 1);
                    
                    // User agent column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'user_agent';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TEXT';
                    
                    // Created at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'created_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    
                    // Updated at column
                    addColumn();
                    document.getElementById(`columnName${columnCount - 1}`).value = 'updated_at';
                    document.getElementById(`columnType${columnCount - 1}`).value = 'TIMESTAMP';
                    document.getElementById(`columnDefault${columnCount - 1}`).value = 'CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP';
                    document.getElementById(`columnNotNull${columnCount - 1}`).checked = true;
                    break;
            }
            
            closeModal('quickActionsModal');
            showToast(`${templateName.charAt(0).toUpperCase() + templateName.slice(1)} template loaded`, 'success');
        }
        
        // Modal functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }
        
        // Toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toast.className = `toast ${type}`;
            toastMessage.textContent = message;
            
            // Update icon based on type
            const icon = toast.querySelector('i');
            switch (type) {
                case 'success':
                    icon.className = 'fas fa-check-circle';
                    break;
                case 'error':
                    icon.className = 'fas fa-exclamation-circle';
                    break;
                case 'info':
                    icon.className = 'fas fa-info-circle';
                    break;
            }
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('show');
                }
            });
        });
    </script>
</body>
</html>
