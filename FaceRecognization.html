<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Face Detection & Capture - Professional Edition</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="favicon.ico">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.11.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/face-landmarks-detection@0.0.3/dist/face-landmarks-detection.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #13f1fc 0%, #0470dc 100%);
            --warning-gradient: linear-gradient(135deg, #f9d423 0%, #ff4e50 100%);
            --dark-bg: #0f0f23;
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #a0a0b8;
            --accent-color: #667eea;
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.18);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Animated background */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            background: linear-gradient(45deg, #0f0f23, #1a1a3e, #16213e, #0f0f23);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .floating-orbs {
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }
        
        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(40px);
            opacity: 0.3;
            animation: float 20s infinite ease-in-out;
        }
        
        .orb1 {
            width: 300px;
            height: 300px;
            background: var(--primary-gradient);
            top: -150px;
            right: -150px;
            animation-delay: 0s;
        }
        
        .orb2 {
            width: 200px;
            height: 200px;
            background: var(--secondary-gradient);
            bottom: -100px;
            left: -100px;
            animation-delay: 5s;
        }
        
        .orb3 {
            width: 250px;
            height: 250px;
            background: var(--success-gradient);
            top: 50%;
            left: 50%;
            animation-delay: 10s;
        }
        
        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }
        
        /* Header */
        .app-header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            padding: 1.25rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo-icon {
            width: 45px;
            height: 45px;
            background: var(--primary-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
        }
        
        .logo-icon i {
            font-size: 1.5rem;
            color: white;
        }
        
        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .logo-text span {
            font-size: 0.75rem;
            color: var(--text-secondary);
            display: block;
        }
        
        /* Main container */
        .main-container {
            padding: 3rem 0;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Video container */
        .video-section {
            margin-bottom: 3rem;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            border-radius: 24px;
            overflow: hidden;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
        
        .video-frame {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%;
            background: #000;
            border-radius: 24px;
            overflow: hidden;
        }
        
        #video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Scanning effect */
        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #00ffff, transparent);
            animation: scan 3s linear infinite;
            z-index: 2;
            display: none;
        }
        
        @keyframes scan {
            0% { top: 0; opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }
        
        /* Face detection overlay */
        .face-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 3;
        }
        
        .face-box {
            position: absolute;
            border: 2px solid #00ffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
            border-radius: 12px;
            display: none;
            animation: pulse-border 2s infinite;
        }
        
        @keyframes pulse-border {
            0%, 100% { border-color: #00ffff; }
            50% { border-color: #ff00ff; }
        }
        
        .face-info {
            position: absolute;
            top: -35px;
            left: 0;
            background: rgba(0, 0, 0, 0.8);
            color: #00ffff;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            white-space: nowrap;
            backdrop-filter: blur(10px);
        }
        
        /* Control panel */
        .controls-section {
            margin-bottom: 3rem;
        }
        
        .control-panel {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
        }
        
        .control-btn {
            padding: 1rem 2rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: relative;
            overflow: hidden;
        }
        
        .control-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: -1;
        }
        
        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
            border-color: var(--accent-color);
        }
        
        .control-btn:hover::before {
            opacity: 0.1;
        }
        
        .control-btn:active {
            transform: translateY(-1px);
        }
        
        .control-btn i {
            font-size: 1.25rem;
        }
        
        .control-btn.capture {
            background: var(--success-gradient);
            border: none;
            color: white;
        }
        
        .control-btn.record {
            background: var(--secondary-gradient);
            border: none;
            color: white;
        }
        
        .control-btn.recording {
            animation: pulse-record 1.5s infinite;
        }
        
        @keyframes pulse-record {
            0% { box-shadow: 0 0 0 0 rgba(245, 87, 108, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(245, 87, 108, 0); }
            100% { box-shadow: 0 0 0 0 rgba(245, 87, 108, 0); }
        }
        
        /* Status panel */
        .status-section {
            margin-bottom: 3rem;
        }
        
        .status-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .section-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .section-icon i {
            font-size: 1.25rem;
            color: white;
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin: 0;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .status-item {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.25rem;
            transition: all 0.3s ease;
        }
        
        .status-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .status-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .status-value {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .status-value.online {
            color: #13f1fc;
        }
        
        .status-value.scanning {
            color: #f9d423;
        }
        
        .status-value.offline {
            color: #f5576c;
        }
        
        /* Settings panel */
        .settings-section {
            margin-bottom: 3rem;
        }
        
        .settings-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
        }
        
        .setting-item {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .setting-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .setting-control {
            width: 100%;
            height: 6px;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }
        
        .setting-control::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary-gradient);
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.5);
        }
        
        .setting-control::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--primary-gradient);
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.5);
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            transition: .4s;
            border-radius: 30px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background: var(--primary-gradient);
            border: none;
        }
        
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 1rem 1.5rem;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            color: var(--text-primary);
            font-weight: 500;
            transform: translateX(120%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 2000;
            display: flex;
            align-items: center;
            gap: 1rem;
            min-width: 300px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .notification.success .notification-icon {
            background: var(--success-gradient);
        }
        
        .notification.error .notification-icon {
            background: var(--secondary-gradient);
        }
        
        .notification-icon i {
            font-size: 1.25rem;
            color: white;
        }
        
        /* Loading indicator */
        .loading-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
        }
        
        .loading-indicator.show {
            display: block;
        }
        
        .loading-ring {
            display: inline-block;
            width: 60px;
            height: 60px;
        }
        
        .loading-ring:after {
            content: " ";
            display: block;
            width: 48px;
            height: 48px;
            margin: 6px;
            border-radius: 50%;
            border: 3px solid var(--glass-border);
            border-color: var(--accent-color) transparent var(--accent-color) transparent;
            animation: loading-ring 1.2s linear infinite;
        }
        
        @keyframes loading-ring {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Canvas for image processing */
        #canvas {
            display: none;
        }
        
        /* Mobile menu */
        .mobile-menu-btn {
            display: none;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            width: 45px;
            height: 45px;
            color: var(--text-primary);
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mobile-menu-btn:hover {
            background: var(--glass-border);
        }
        
        .mobile-menu {
            position: fixed;
            top: 0;
            left: -100%;
            width: 85%;
            max-width: 350px;
            height: 100vh;
            background: var(--dark-bg);
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 2001;
            padding: 2rem 1.5rem;
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
        }
        
        .mobile-menu.show {
            left: 0;
        }
        
        .mobile-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .mobile-menu-close {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            width: 40px;
            height: 40px;
            color: var(--text-primary);
            font-size: 1.25rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .mobile-menu-close:hover {
            background: var(--glass-border);
        }
        
        .mobile-menu-section {
            margin-bottom: 2rem;
        }
        
        .mobile-menu-title {
            font-size: 0.875rem;
            font-weight: 700;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .mobile-menu-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 12px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 0.5rem;
        }
        
        .mobile-menu-item:hover {
            background: var(--glass-bg);
            transform: translateX(5px);
        }
        
        .mobile-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            display: none;
            backdrop-filter: blur(5px);
        }
        
        .mobile-menu-overlay.show {
            display: block;
        }
        
        /* Responsive adjustments */
        @media (max-width: 992px) {
            .main-container {
                padding: 2rem 1rem;
            }
            
            .status-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .desktop-nav {
                display: none;
            }
            
            .control-panel {
                flex-direction: column;
                align-items: center;
            }
            
            .control-btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .status-grid {
                grid-template-columns: 1fr;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 576px) {
            .logo-text h1 {
                font-size: 1.25rem;
            }
            
            .video-container {
                border-radius: 16px;
            }
            
            .status-panel, .settings-panel {
                padding: 1.5rem;
                border-radius: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- Animated background -->
    <div class="bg-animation"></div>
    <div class="floating-orbs">
        <div class="orb orb1"></div>
        <div class="orb orb2"></div>
        <div class="orb orb3"></div>
    </div>
    
    <!-- Header -->
    <header class="app-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-camera"></i>
                    </div>
                    <div class="logo-text">
                        <h1>Face Detection Pro</h1>
                        <span>Neural Interface v3.0</span>
                    </div>
                </div>
                
                <div class="desktop-nav">
                    <button class="control-btn" onclick="window.location.href='index.html'">
                        <i class="fas fa-home"></i>
                        Home
                    </button>
                </div>
                
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>
    
    <!-- Mobile Menu -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <h2>Menu</h2>
            <button class="mobile-menu-close" id="mobileMenuClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="mobile-menu-section">
            <div class="mobile-menu-title">Navigation</div>
            <div class="mobile-menu-item" onclick="window.location.href='index.html'">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </div>
        </div>
        
        <div class="mobile-menu-section">
            <div class="mobile-menu-title">Settings</div>
            <div class="mobile-menu-item" onclick="toggleMobileSetting('autoCapture')">
                <i class="fas fa-camera"></i>
                <span>Auto Capture</span>
                <div class="toggle-switch" style="margin-left: auto;">
                    <input type="checkbox" id="mobileAutoCapture">
                    <span class="slider"></span>
                </div>
            </div>
            <div class="mobile-menu-item" onclick="toggleMobileSetting('enhancedFilters')">
                <i class="fas fa-magic"></i>
                <span>Enhanced Filters</span>
                <div class="toggle-switch" style="margin-left: auto;">
                    <input type="checkbox" id="mobileEnhancedFilters" checked>
                    <span class="slider"></span>
                </div>
            </div>
            <div class="mobile-menu-item" onclick="toggleMobileSetting('voiceControl')">
                <i class="fas fa-microphone"></i>
                <span>Voice Control</span>
                <div class="toggle-switch" style="margin-left: auto;">
                    <input type="checkbox" id="mobileVoiceControl">
                    <span class="slider"></span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main container -->
    <div class="container main-container">
        <!-- Video Section -->
        <div class="video-section">
            <div class="video-container">
                <div class="video-frame">
                    <video id="video" autoplay></video>
                    <div class="scan-line"></div>
                    <div class="face-overlay" id="faceOverlay">
                        <div class="face-box" id="faceBox">
                            <div class="face-info" id="faceInfo">Face Detected</div>
                        </div>
                    </div>
                    <div class="loading-indicator" id="loadingIndicator">
                        <div class="loading-ring"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Controls Section -->
        <div class="controls-section">
            <div class="control-panel">
                <button id="capture" class="control-btn capture">
                    <i class="fas fa-camera"></i>
                    Capture Image
                </button>
                <button id="startRecord" class="control-btn record">
                    <i class="fas fa-video"></i>
                    Start Recording
                </button>
                <button id="stopRecord" class="control-btn record hidden">
                    <i class="fas fa-stop"></i>
                    Stop Recording
                </button>
                <button id="enhance" class="control-btn">
                    <i class="fas fa-magic"></i>
                    Enhance
                </button>
                <button id="analyze" class="control-btn">
                    <i class="fas fa-chart-line"></i>
                    Analyze
                </button>
            </div>
        </div>
        
        <!-- Status Section -->
        <div class="status-section">
            <div class="status-panel">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-satellite-dish"></i>
                    </div>
                    <h3 class="section-title">System Status</h3>
                </div>
                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-label">
                            <i class="fas fa-server"></i>
                            System Status
                        </div>
                        <div class="status-value online" id="systemStatus">Online</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">
                            <i class="fas fa-user-check"></i>
                            Face Detection
                        </div>
                        <div class="status-value scanning" id="detectionStatus">Scanning...</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">
                            <i class="fas fa-tv"></i>
                            Camera Resolution
                        </div>
                        <div class="status-value" id="resolution">Detecting...</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">
                            <i class="fas fa-cogs"></i>
                            Processing Mode
                        </div>
                        <div class="status-value" id="processingMode">Standard</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Settings Section -->
        <div class="settings-section">
            <div class="settings-panel">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-sliders-h"></i>
                    </div>
                    <h3 class="section-title">Settings</h3>
                </div>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label class="setting-label">
                            <i class="fas fa-tachometer-alt"></i>
                            Face Detection Sensitivity
                        </label>
                        <input type="range" class="setting-control" id="sensitivity" min="1" max="10" value="5">
                    </div>
                    <div class="setting-item">
                        <label class="setting-label">
                            <i class="fas fa-camera"></i>
                            Auto Capture
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="autoCapture">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label class="setting-label">
                            <i class="fas fa-magic"></i>
                            Enhanced Filters
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="enhancedFilters" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label class="setting-label">
                            <i class="fas fa-microphone"></i>
                            Voice Control
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="voiceControl">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon">
            <i class="fas fa-check"></i>
        </div>
        <span id="notificationText">Notification message</span>
    </div>
    
    <!-- Canvas for image processing -->
    <canvas id="canvas"></canvas>
    
    <script>
        $(document).ready(function(){
            let video = document.getElementById("video");
            let canvas = document.getElementById("canvas");
            let context = canvas.getContext("2d");
            let mediaRecorder;
            let recordedChunks = [];
            let model;
            let faceDetectionInterval;
            let isVoiceControlActive = false;
            let recognition;
            
            // Mobile menu
            $('#mobileMenuBtn').click(function() {
                $('#mobileMenu').addClass('show');
                $('#mobileMenuOverlay').addClass('show');
            });
            
            $('#mobileMenuClose, #mobileMenuOverlay').click(function() {
                $('#mobileMenu').removeClass('show');
                $('#mobileMenuOverlay').removeClass('show');
            });
            
            // Initialize face detection model
            async function initializeModel() {
                $('#loadingIndicator').addClass('show');
                $('#systemStatus').text('Loading AI Model...');
                $('#systemStatus').removeClass('online scanning offline').addClass('scanning');
                
                try {
                    model = await faceLandmarksDetection.load(
                        faceLandmarksDetection.SupportedPackages.mediapipeFacemesh,
                        { maxFaces: 1 }
                    );
                    
                    $('#loadingIndicator').removeClass('show');
                    $('#systemStatus').text('Online');
                    $('#systemStatus').removeClass('online scanning offline').addClass('online');
                    showNotification('AI Model Loaded Successfully', 'success');
                    
                    // Start face detection
                    startFaceDetection();
                } catch (error) {
                    console.error('Failed to load model:', error);
                    $('#loadingIndicator').removeClass('show');
                    $('#systemStatus').text('Limited Mode');
                    $('#systemStatus').removeClass('online scanning offline').addClass('offline');
                    showNotification('Failed to load AI model. Using basic detection.', 'error');
                }
            }
            
            // Start face detection
            function startFaceDetection() {
                if (!model) return;
                
                faceDetectionInterval = setInterval(async () => {
                    try {
                        const predictions = await model.estimateFaces({
                            input: video,
                            returnTensors: false,
                            flipHorizontal: false
                        });
                        
                        if (predictions.length > 0) {
                            // Face detected
                            $('#detectionStatus').text('Face Detected');
                            $('#detectionStatus').removeClass('online scanning offline').addClass('online');
                            $('#faceBox').css('display', 'block');
                            
                            // Get face bounding box
                            const face = predictions[0];
                            const boundingBox = face.boundingBox;
                            const topLeft = boundingBox.topLeft;
                            const bottomRight = boundingBox.bottomRight;
                            
                            // Position the face box
                            const videoWidth = video.videoWidth;
                            const videoHeight = video.videoHeight;
                            const videoElementWidth = video.offsetWidth;
                            const videoElementHeight = video.offsetHeight;
                            
                            const scaleX = videoElementWidth / videoWidth;
                            const scaleY = videoElementHeight / videoHeight;
                            
                            const boxWidth = (bottomRight[0] - topLeft[0]) * scaleX;
                            const boxHeight = (bottomRight[1] - topLeft[1]) * scaleY;
                            const boxLeft = topLeft[0] * scaleX;
                            const boxTop = topLeft[1] * scaleY;
                            
                            $('#faceBox').css({
                                left: `${boxLeft}px`,
                                top: `${boxTop}px`,
                                width: `${boxWidth}px`,
                                height: `${boxHeight}px`
                            });
                            
                            // Update face info
                            const confidence = Math.round(face.faceInViewConfidence * 100);
                            $('#faceInfo').text(`Face: ${confidence}%`);
                            
                            // Auto capture if enabled
                            if ($('#autoCapture').is(':checked') && confidence > 80) {
                                setTimeout(() => {
                                    if ($('#autoCapture').is(':checked')) {
                                        captureImage();
                                    }
                                }, 1000);
                            }
                        } else {
                            // No face detected
                            $('#detectionStatus').text('Scanning...');
                            $('#detectionStatus').removeClass('online scanning offline').addClass('scanning');
                            $('#faceBox').css('display', 'none');
                        }
                    } catch (error) {
                        console.error('Face detection error:', error);
                    }
                }, 100);
            }
            
            // Initialize camera
            navigator.mediaDevices.getUserMedia({ 
                video: { 
                    width: { ideal: 1280 },
                    height: { ideal: 720 }
                } 
            })
            .then(stream => { 
                video.srcObject = stream;
                
                // Get video resolution
                video.addEventListener('loadedmetadata', () => {
                    const width = video.videoWidth;
                    const height = video.videoHeight;
                    $('#resolution').text(`${width}x${height}`);
                    
                    // Set canvas dimensions
                    canvas.width = width;
                    canvas.height = height;
                });
                
                // Initialize media recorder
                mediaRecorder = new MediaRecorder(stream);
                
                mediaRecorder.ondataavailable = event => {
                    if (event.data.size > 0) {
                        recordedChunks.push(event.data);
                    }
                };
                
                mediaRecorder.onstop = () => {
                    const blob = new Blob(recordedChunks, { type: "video/webm" });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement("a");
                    link.href = url;
                    link.download = `recording_${new Date().getTime()}.webm`;
                    link.click();
                    
                    recordedChunks = [];
                    showNotification('Video saved successfully', 'success');
                };
                
                // Initialize AI model
                initializeModel();
            })
            .catch(err => { 
                console.error('Camera access error:', err);
                showNotification('Camera access denied!', 'error');
                $('#systemStatus').text('Offline');
                $('#systemStatus').removeClass('online scanning offline').addClass('offline');
            });
            
            // Capture image
            function captureImage() {
                context.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                // Apply enhanced filters if enabled
                if ($('#enhancedFilters').is(':checked')) {
                    applyEnhancedFilters();
                }
                
                // Create download link
                const link = document.createElement('a');
                link.href = canvas.toDataURL('image/png');
                link.download = `capture_${new Date().getTime()}.png`;
                link.click();
                
                showNotification('Image captured successfully', 'success');
            }
            
            // Apply enhanced filters
            function applyEnhancedFilters() {
                const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Apply a professional filter
                for (let i = 0; i < data.length; i += 4) {
                    // Enhance contrast and saturation
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    
                    // Apply a subtle color enhancement
                    data[i] = Math.min(255, r * 1.05);     // Red
                    data[i + 1] = Math.min(255, g * 1.05); // Green
                    data[i + 2] = Math.min(255, b * 1.1);  // Blue
                }
                
                context.putImageData(imageData, 0, 0);
            }
            
            // Show notification
            function showNotification(message, type) {
                const notification = $('#notification');
                const notificationText = $('#notificationText');
                const icon = notification.find('.notification-icon i');
                
                notificationText.text(message);
                notification.removeClass('success error').addClass(type);
                
                if (type === 'success') {
                    icon.removeClass('fa-exclamation-circle').addClass('fa-check');
                } else if (type === 'error') {
                    icon.removeClass('fa-check').addClass('fa-exclamation-circle');
                }
                
                notification.addClass('show');
                
                setTimeout(() => {
                    notification.removeClass('show');
                }, 3000);
            }
            
            // Button event handlers
            $("#capture").click(function(){
                captureImage();
            });
            
            $("#startRecord").click(function(){
                recordedChunks = [];
                mediaRecorder.start();
                $("#startRecord").addClass("hidden recording");
                $("#stopRecord").removeClass("hidden");
                showNotification('Recording started', 'success');
            });
            
            $("#stopRecord").click(function(){
                mediaRecorder.stop();
                $("#stopRecord").addClass("hidden");
                $("#startRecord").removeClass("hidden recording");
            });
            
            $("#enhance").click(function(){
                $('#processingMode').text('Enhancement');
                $('#loadingIndicator').addClass('show');
                
                setTimeout(() => {
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    applyEnhancedFilters();
                    
                    // Create download link
                    const link = document.createElement('a');
                    link.href = canvas.toDataURL('image/png');
                    link.download = `enhanced_${new Date().getTime()}.png`;
                    link.click();
                    
                    $('#loadingIndicator').removeClass('show');
                    $('#processingMode').text('Standard');
                    showNotification('Image enhanced and saved', 'success');
                }, 1500);
            });
            
            $("#analyze").click(function(){
                $('#processingMode').text('Analysis');
                $('#loadingIndicator').addClass('show');
                
                setTimeout(() => {
                    // Simulate analysis
                    const analysisResults = [
                        'Face Match: 98.7%',
                        'Emotion: Neutral',
                        'Age Estimate: 25-30',
                        'Attention Level: High'
                    ];
                    
                    $('#loadingIndicator').removeClass('show');
                    $('#processingMode').text('Standard');
                    
                    // Display results
                    let resultText = 'Analysis Results:\n';
                    analysisResults.forEach(result => {
                        resultText += `${result}\n`;
                    });
                    
                    showNotification('Analysis complete', 'success');
                    alert(resultText);
                }, 2000);
            });
            
            // Settings synchronization
            $('#autoCapture').change(function() {
                $('#mobileAutoCapture').prop('checked', $(this).is(':checked'));
            });
            
            $('#mobileAutoCapture').change(function() {
                $('#autoCapture').prop('checked', $(this).is(':checked'));
            });
            
            $('#enhancedFilters').change(function() {
                $('#mobileEnhancedFilters').prop('checked', $(this).is(':checked'));
            });
            
            $('#mobileEnhancedFilters').change(function() {
                $('#enhancedFilters').prop('checked', $(this).is(':checked'));
            });
            
            $('#voiceControl').change(function() {
                $('#mobileVoiceControl').prop('checked', $(this).is(':checked'));
                handleVoiceControlChange();
            });
            
            $('#mobileVoiceControl').change(function() {
                $('#voiceControl').prop('checked', $(this).is(':checked'));
                handleVoiceControlChange();
            });
            
            function toggleMobileSetting(setting) {
                const checkbox = document.getElementById('mobile' + setting.charAt(0).toUpperCase() + setting.slice(1));
                checkbox.checked = !checkbox.checked;
                $(checkbox).trigger('change');
            }
            
            // Voice control
            function initializeVoiceControl() {
                if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                    showNotification('Voice control not supported in this browser', 'error');
                    return;
                }
                
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.continuous = true;
                recognition.interimResults = false;
                recognition.lang = 'en-US';
                
                recognition.onresult = function(event) {
                    const command = event.results[event.results.length - 1][0].transcript.toLowerCase();
                    
                    if (command.includes('capture') || command.includes('take picture')) {
                        captureImage();
                    } else if (command.includes('start recording')) {
                        if ($('#startRecord').is(':visible')) {
                            $('#startRecord').click();
                        }
                    } else if (command.includes('stop recording')) {
                        if ($('#stopRecord').is(':visible')) {
                            $('#stopRecord').click();
                        }
                    } else if (command.includes('enhance')) {
                        $('#enhance').click();
                    } else if (command.includes('analyze')) {
                        $('#analyze').click();
                    }
                    
                    showNotification(`Command recognized: "${command}"`, 'success');
                };
                
                recognition.onerror = function(event) {
                    console.error('Speech recognition error:', event.error);
                    if (event.error === 'no-speech') {
                        // Continue listening
                        recognition.start();
                    }
                };
                
                recognition.onend = function() {
                    if (isVoiceControlActive) {
                        // Restart recognition if it's still active
                        recognition.start();
                    }
                };
            }
            
            function handleVoiceControlChange() {
                if ($('#voiceControl').is(':checked')) {
                    if (!recognition) {
                        initializeVoiceControl();
                    }
                    
                    isVoiceControlActive = true;
                    recognition.start();
                    showNotification('Voice control activated', 'success');
                } else {
                    isVoiceControlActive = false;
                    if (recognition) {
                        recognition.stop();
                    }
                    showNotification('Voice control deactivated', 'success');
                }
            }
        });
    </script>
</body>
</html>

